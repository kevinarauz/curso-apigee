<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capacitación Apigee Edge | Diseño Avanzado</title>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <style>
        /*
        ==========================================================================
        STYLE GUIDE & DESIGN SYSTEM
        ==========================================================================
        * **Framework:** Bootstrap 5.3
        * **Font:** 'Inter', sans-serif
        * **Primary Color:** #0052D4 (Azul Eléctrico)
        * **Secondary Color:** #6C757D (Gris Neutro)
        * **Accent/Gradient:** Linear gradient from #0052D4 to #4364F7 to #6FB1FC
        * **Layout:** Generous whitespace, responsive, mobile-first approach.
        * **Components:** Soft shadows, subtle gradients, rounded corners (0.75rem).
        * **Interactivity:** Smooth transitions, transform effects on hover, glowing effects.
        * **Icons:** Bootstrap Icons (Font-based, integrated).
        ==========================================================================
        */

        :root {
            --primary-color: #0052D4;
            --secondary-color: #6c757d;
            --background-light: #f8f9fa;
            --background-dark: #1a1d24;
            --text-light: #f8f9fa;
            --text-dark: #212529;
            --border-color: #dee2e6;
            --card-bg: #ffffff;
            --font-family-sans-serif: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --bs-border-radius: 0.75rem;
        }

        /* Progress indicator while scrolling */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), #4364F7);
            z-index: 9999;
            transition: width 0.1s ease;
        }

        body {
            font-family: var(--font-family-sans-serif);
            background-color: var(--background-light);
            color: var(--text-dark);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- Global Component Styling --- */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            color: var(--text-dark);
        }

        .section-title {
            font-weight: 800;
            margin-bottom: 3rem;
            text-align: center;
        }

        .section-title .bi {
            margin-right: 0.75rem;
            color: var(--primary-color);
        }

        /* --- Navigation Bar --- */
        .navbar {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .navbar.scrolled {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(20px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-weight: 800;
            color: var(--primary-color) !important;
        }
        .nav-link {
            font-weight: 600;
            color: #555 !important;
            transition: all 0.2s ease;
            border-radius: 6px;
            margin: 0 2px;
        }
        .nav-link:hover, .nav-link.active {
            color: var(--primary-color) !important;
            background-color: rgba(0, 82, 212, 0.1);
            transform: translateY(-1px);
        }

        /* --- Hero Section --- */
        .hero {
            padding: 8rem 0;
            background-color: var(--background-dark);
            color: var(--text-light);
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: radial-gradient(circle at 20% 80%, rgba(0, 82, 212, 0.3), transparent 40%),
                              radial-gradient(circle at 80% 30%, rgba(67, 100, 247, 0.2), transparent 40%);
            z-index: 1;
        }
        .hero .container {
            position: relative;
            z-index: 2;
        }
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--text-light);
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .hero .lead {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.8);
        }
        .hero .btn {
            padding: 1rem 2.5rem;
            font-weight: 700;
            border-radius: 50px;
            transition: all 0.3s ease;
        }
        .btn-primary-gradient {
            background: linear-gradient(90deg, var(--primary-color), #4364F7);
            color: white;
            border: none;
            box-shadow: 0 4px 20px rgba(0, 82, 212, 0.4);
        }
        .btn-primary-gradient:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(0, 82, 212, 0.5);
        }
        .btn-outline-light {
            border-width: 2px;
        }
        .btn-outline-light:hover {
            background-color: var(--text-light);
            color: var(--background-dark);
        }

        /* --- Modern Cards --- */
        .module-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--bs-border-radius);
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .module-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
            transition: left 0.5s ease;
        }
        
        .module-card:hover::before {
            left: 100%;
        }
        
        .module-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,82,212,0.15);
        }
        
        .module-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .module-number {
            background: linear-gradient(135deg, var(--primary-color), #4364F7);
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            margin-right: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 82, 212, 0.3);
        }
        
        .concept-box {
            background-color: #e9ecef;
            border-left: 5px solid var(--primary-color);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        /* --- Feature Cards (Fundamentals Section) --- */
        .feature-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--bs-border-radius);
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            height: 100%;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 8px 25px rgba(0, 82, 212, 0.1);
        }
        .feature-card .icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-color), #6FB1FC);
            color: white;
            box-shadow: 0 4px 10px rgba(0, 82, 212, 0.2);
            font-size: 1.5rem;
        }

        /* --- AI Assistant Section --- */
        #asistente-ai .card {
            background: var(--background-dark);
            color: var(--text-light);
            border: none;
            overflow: hidden;
        }
        #asistente-ai .card::before {
             content: '';
            position: absolute;
            top: -100px; right: -100px;
            width: 300px; height: 300px;
            background: radial-gradient(circle, rgba(0, 82, 212, 0.5), transparent 70%);
            animation: pulse 5s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }
        #ai-concept-input {
            background-color: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.2);
            color: white;
        }
        #ai-concept-input::placeholder { color: rgba(255,255,255,0.5); }
        #ai-concept-input:focus {
            background-color: rgba(255,255,255,0.15);
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(0, 82, 212, 0.5);
        }

        /* --- Code Blocks --- */
        pre {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0.5rem;
            position: relative;
            font-family: 'SF Mono', 'Fira Code', 'Menlo', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
        }
        .copy-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: #333;
            color: #ccc;
            border: 1px solid #555;
            border-radius: 0.25rem;
            padding: 0.25rem 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .copy-btn:hover {
            background-color: #444;
            color: white;
        }
        .copy-btn.copied {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .xml-tag { color: #569cd6; }
        .xml-attribute { color: #9cdcfe; }
        .xml-value { color: #ce9178; }
        .xml-comment { color: #6a9955; }

        /* --- Modals --- */
        .modal-content {
            border: none;
            box-shadow: 0 1rem 3rem rgba(0,0,0,0.1);
        }
        .modal-header {
            background: linear-gradient(90deg, var(--primary-color), #4364F7);
            color: white;
            border-bottom: none;
        }
        .modal-title { color: white; }
        .btn-close { filter: invert(1) grayscale(100%) brightness(200%); }

        /* --- Footer --- */
        .footer {
            background-color: var(--background-dark);
            color: rgba(255, 255, 255, 0.7);
            padding: 4rem 0;
            margin-top: 5rem;
        }
        .footer h5 {
            color: white;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        .footer a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .footer a:hover {
            color: white;
        }
        .footer .list-unstyled li {
            margin-bottom: 0.5rem;
        }
        .footer hr {
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        /* --- Utility Classes --- */
        .bg-light-blue {
            background-color: #e7f0ff;
        }
        .text-primary {
            color: var(--primary-color) !important;
        }
        .section-separator {
            margin: 6rem 0;
        }

        /* --- Search Functionality --- */
        .search-container {
            position: relative;
        }
        
        .search-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .search-result-item {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .search-result-item:hover {
            background-color: #f8f9fa;
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .search-result-title {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 0.9rem;
        }
        
        .search-result-context {
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.25rem;
        }

        /* --- Dark Theme --- */
        [data-theme="dark"] {
            --background-light: #1a1d24;
            --background-dark: #000000;
            --text-light: #ffffff;
            --text-dark: #f8f9fa;
            --border-color: #333;
            --card-bg: #2d3339;
        }
        
        [data-theme="dark"] body {
            background-color: var(--background-light);
            color: var(--text-dark);
        }
        
        [data-theme="dark"] .navbar {
            background: rgba(26, 29, 36, 0.8) !important;
        }
        
        [data-theme="dark"] .navbar.scrolled {
            background: rgba(26, 29, 36, 0.95) !important;
        }
        
        [data-theme="dark"] .module-card,
        [data-theme="dark"] .feature-card,
        [data-theme="dark"] .card {
            background: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-dark);
        }
        
        [data-theme="dark"] .search-dropdown {
            background: var(--card-bg);
            border-color: var(--border-color);
        }
        
        [data-theme="dark"] .search-result-item:hover {
            background-color: #3a3f46;
        }

        /* --- Dark Theme Extensions for Module Content --- */
        [data-theme="dark"] .concept-box {
            background-color: #2a2d33;
            border-left-color: var(--primary-color);
            color: var(--text-dark);
        }

        [data-theme="dark"] .bg-light-blue {
            background-color: #2a3441 !important;
        }

        [data-theme="dark"] .list-group-item {
            background-color: transparent !important;
            color: var(--text-dark);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .accordion-item {
            background-color: var(--card-bg);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .accordion-button {
            background-color: var(--card-bg);
            color: var(--text-dark);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .accordion-button:not(.collapsed) {
            background-color: #3a3f46;
            color: var(--text-dark);
        }

        [data-theme="dark"] .accordion-body {
            background-color: var(--card-bg);
            color: var(--text-dark);
        }

        [data-theme="dark"] .border {
            border-color: var(--border-color) !important;
        }

        [data-theme="dark"] .rounded {
            background-color: var(--card-bg) !important;
            color: var(--text-dark);
        }

        [data-theme="dark"] pre {
            background-color: #1e1e1e !important;
            border-color: var(--border-color);
        }

        /* --- Dark Theme for AI Modal --- */
        [data-theme="dark"] .modal-content {
            background-color: var(--card-bg);
            color: var(--text-dark);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .modal-header {
            background: linear-gradient(90deg, var(--primary-color), #4364F7);
            border-bottom: 1px solid var(--border-color);
        }

        [data-theme="dark"] .modal-body {
            background-color: var(--card-bg);
            color: var(--text-dark);
        }

        [data-theme="dark"] .modal-footer {
            background-color: var(--card-bg);
            border-top: 1px solid var(--border-color);
        }

        [data-theme="dark"] .alert-primary {
            background-color: rgba(0, 82, 212, 0.15);
            border-color: rgba(0, 82, 212, 0.3);
            color: var(--text-dark);
        }

        [data-theme="dark"] .alert-warning {
            background-color: rgba(255, 193, 7, 0.15);
            border-color: rgba(255, 193, 7, 0.3);
            color: var(--text-dark);
        }

        [data-theme="dark"] .alert-info {
            background-color: rgba(13, 202, 240, 0.15);
            border-color: rgba(13, 202, 240, 0.3);
            color: var(--text-dark);
        }

        [data-theme="dark"] .bg-light {
            background-color: #3a3f46 !important;
            color: var(--text-dark) !important;
        }

        [data-theme="dark"] .card.bg-light {
            background-color: #3a3f46 !important;
            border-color: var(--border-color);
        }

        [data-theme="dark"] .bg-dark {
            background-color: #1e1e1e !important;
            color: #d4d4d4 !important;
        }

        [data-theme="dark"] .text-muted {
            color: #888 !important;
        }

        [data-theme="dark"] .text-success {
            color: #28a745 !important;
        }

        [data-theme="dark"] .text-info {
            color: #17a2b8 !important;
        }

        [data-theme="dark"] .list-unstyled li {
            color: var(--text-dark);
        }

        /* --- Enhanced AI Modal Styling --- */
        .ai-modal-icon {
            background: linear-gradient(135deg, var(--primary-color), #6FB1FC);
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 82, 212, 0.3);
        }

        .ai-definition-box {
            background: linear-gradient(135deg, rgba(0, 82, 212, 0.1), rgba(111, 177, 252, 0.05));
            border-left: 4px solid var(--primary-color);
            border-radius: 8px;
        }

        [data-theme="dark"] .ai-definition-box {
            background: linear-gradient(135deg, rgba(0, 82, 212, 0.2), rgba(111, 177, 252, 0.1));
            border-left-color: var(--primary-color);
        }

        .ai-analogy-box {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 1px solid #dee2e6;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .ai-analogy-box {
            background: linear-gradient(135deg, #3a3f46, #2d3339);
            border-color: var(--border-color);
        }

        .ai-analogy-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .ai-analogy-box:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .ai-benefit-item {
            transition: all 0.2s ease;
            padding: 8px 0;
            border-radius: 6px;
        }

        .ai-benefit-item:hover {
            background-color: rgba(0, 82, 212, 0.05);
            padding-left: 10px;
        }

        [data-theme="dark"] .ai-benefit-item:hover {
            background-color: rgba(0, 82, 212, 0.1);
        }

        .ai-example-box {
            background: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .ai-example-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), #6FB1FC);
        }

        .ai-xml-context {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.05));
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 8px;
        }

        [data-theme="dark"] .ai-xml-context {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 193, 7, 0.08));
            border-color: rgba(255, 193, 7, 0.4);
        }

        /* --- Dark Theme Modal Footer Border --- */
        [data-theme="dark"] .ai-modal-footer {
            border-top-color: var(--border-color) !important;
        }

        /* --- Strategic Recommendation Box --- */
        .strategic-recommendation {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .strategic-recommendation {
            background: linear-gradient(135deg, #2a2d33 0%, #1e2025 100%);
            border-color: var(--border-color);
            color: var(--text-dark);
        }

        .strategic-recommendation h5 {
            color: inherit;
        }

        [data-theme="dark"] .strategic-recommendation h5 {
            color: var(--text-dark);
        }

        .strategic-recommendation h6 {
            color: inherit;
        }

        [data-theme="dark"] .strategic-recommendation h6.text-success {
            color: #28a745 !important;
        }

        [data-theme="dark"] .strategic-recommendation h6.text-primary {
            color: var(--primary-color) !important;
        }

        .strategic-recommendation ul {
            color: inherit;
        }

        [data-theme="dark"] .strategic-recommendation ul {
            color: var(--text-dark);
        }

        [data-theme="dark"] .strategic-recommendation .small {
            color: rgba(248, 249, 250, 0.8);
        }

        /* --- Diagram Images Styling --- */
        .strategic-recommendation img {
            transition: all 0.3s ease;
            background-color: white;
            padding: 10px;
        }

        [data-theme="dark"] .strategic-recommendation img {
            background-color: #2a2d33;
            border-color: var(--border-color) !important;
        }

        .strategic-recommendation img:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        [data-theme="dark"] .strategic-recommendation img:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        /* --- Print Styles --- */
        @media print {
            .navbar,
            .scroll-progress,
            #theme-toggle,
            .btn,
            .search-container,
            .hero .btn,
            #asistente-ai,
            .footer {
                display: none !important;
            }
            
            body {
                font-size: 12pt;
                line-height: 1.4;
                color: black !important;
                background: white !important;
            }
            
            .hero {
                background: white !important;
                color: black !important;
                padding: 2rem 0 !important;
            }
            
            .hero h1 {
                color: black !important;
                font-size: 24pt !important;
            }
            
            .module-card {
                break-inside: avoid;
                page-break-inside: avoid;
                margin-bottom: 1rem;
                border: 1px solid #ddd;
                box-shadow: none !important;
            }
            
            .section-separator {
                margin: 2rem 0;
                border-color: #ddd;
            }
            
            pre {
                background: #f5f5f5 !important;
                color: black !important;
                border: 1px solid #ddd;
                font-size: 10pt;
            }
            
            .copy-btn {
                display: none !important;
            }
            
            /* Ensure images print well */
            .strategic-recommendation img {
                background: white !important;
                border: 1px solid #ddd !important;
                box-shadow: none !important;
                max-width: 100% !important;
                page-break-inside: avoid;
            }
        }

        /* --- Enhanced Accessibility --- */
        @media (prefers-contrast: high) {
            :root {
                --primary-color: #003399;
                --background-light: #ffffff;
                --text-dark: #000000;
                --border-color: #333333;
            }
        }
        
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .scroll-progress {
                transition: none !important;
            }
        }

        /* --- Enhanced Mobile Responsiveness --- */
        @media (max-width: 768px) {
            .hero-section {
                min-height: 60vh;
                padding: 4rem 0;
            }
            
            .hero-section h1 {
                font-size: 2.5rem;
                margin-bottom: 1rem;
            }
            
            .hero-section .lead {
                font-size: 1.1rem;
            }
            
            .module-card {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }
            
            .module-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .module-number {
                align-self: flex-start;
            }
            
            .container-fluid {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .nav-link {
                padding: 0.5rem 0.75rem;
            }
            
            .search-container {
                width: 100% !important;
                margin-bottom: 0.5rem;
            }
            
            #global-search {
                width: 100% !important;
            }
        }
        
        @media (max-width: 576px) {
            .hero-section h1 {
                font-size: 2rem;
            }
            
            .module-card {
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .btn {
                font-size: 0.9rem;
                padding: 0.5rem 1rem;
            }
            
            .navbar-nav {
                text-align: center;
            }
            
            .search-container {
                margin: 0.5rem 0;
            }
        }

    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#navbar-main" data-bs-offset="100">
    
    <div id="scroll-progress" class="scroll-progress"></div>

    <!-- Barra de Navegación -->
    <nav id="navbar-main" class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-box-seam-fill me-2"></i> Apigee Training
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <div class="search-container me-3">
                            <input type="text" id="global-search" class="form-control form-control-sm" placeholder="Buscar en el manual..." style="width: 200px;">
                            <div id="search-results" class="search-dropdown"></div>
                        </div>
                    </li>
                    <li class="nav-item"><a class="nav-link active" href="#inicio">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#fundamentos">Fundamentos</a></li>
                    <li class="nav-item"><a class="nav-link" href="#diferencias-versiones">Edge vs X</a></li>
                    <li class="nav-item"><a class="nav-link" href="#que-es-api">¿Qué es una API?</a></li>
                    <li class="nav-item"><a class="nav-link" href="#asistente-ai">Asistente AI</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="modulosDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-list-ul me-1"></i> Módulos
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="modulosDropdown">
                            <li><a class="dropdown-item" href="#creacion"><i class="bi bi-plus-circle me-2"></i> Módulo 1: Creación</a></li>
                            <li><a class="dropdown-item" href="#componentes"><i class="bi bi-gear me-2"></i> Módulo 2: Componentes</a></li>
                            <li><a class="dropdown-item" href="#estructura"><i class="bi bi-diagram-3 me-2"></i> Módulo 3: Estructura</a></li>
                            <li><a class="dropdown-item" href="#publicacion"><i class="bi bi-share me-2"></i> Módulo 4: Publicación</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-outline-primary btn-sm ms-2" id="theme-toggle" title="Cambiar tema">
                            <i class="bi bi-moon-fill"></i>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-primary btn-sm ms-2" onclick="showPrintDialog()" title="Imprimir manual">
                            <i class="bi bi-printer-fill"></i>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Sección Hero -->
    <header id="inicio" class="hero">
        <div class="container text-center">
             <h1 class="display-3 fw-bold text-white mb-4 animate__animated animate__fadeInDown">
                <i class="bi bi-book-half me-2"></i> Capacitación de 
                <span style="color: #6FB1FC;">Apigee Edge</span>
            </h1>
            <div class="mb-4 animate__animated animate__fadeInUp animate__delay-500ms">
                <p class="mb-2 text-white-50">
                    <i class="bi bi-person-workspace me-2"></i>Diseñado y desarrollado por
                </p>
                <h4 class="fw-bold text-white mb-1">Kevin Araúz</h4>
                <p class="text-white-50 mb-0">
                    <i class="bi bi-award me-2"></i>Arquitecto de Soluciones TI
                </p>
            </div>
            <p class="lead mb-5 mx-auto animate__animated animate__fadeInUp" style="max-width: 700px;">
                Guía técnica completa para el personal: desde fundamentos hasta implementación avanzada. Ideal para capacitación, consulta rápida y referencia diaria.
            </p>
            <div class="d-flex justify-content-center gap-3 animate__animated animate__fadeInUp animate__delay-1s">
                <a href="#fundamentos" class="btn btn-primary-gradient">
                    <i class="bi bi-rocket-takeoff-fill me-2"></i> Iniciar Manual
                </a>
                <a href="#" class="btn btn-outline-light" onclick="downloadPDF()">
                    <i class="bi bi-download me-2"></i> Descargar PDF
                </a>
            </div>
        </div>
    </header>

    <main class="container my-5 py-5">

        <!-- Sección Fundamentos -->
        <section id="fundamentos">
            <h2 class="section-title"><i class="bi bi-journal-bookmark-fill"></i>Módulo 0: Fundamentos de Apigee</h2>
            <p class="lead text-center mb-5" style="max-width: 800px; margin: 0 auto;">Apigee es una plataforma de gestión de APIs que actúa como una fachada inteligente para tus servicios de backend. Piensa en ello como el conserje de un hotel de lujo para tus datos.</p>
            
            <!-- Información sobre Apigee Edge vs Apigee X -->
            <div class="alert alert-warning mb-5" role="alert">
                <div class="d-flex align-items-center mb-3">
                    <i class="bi bi-info-circle-fill me-3" style="font-size: 1.5rem;"></i>
                    <h5 class="alert-heading mb-0">📍 Importante: Estamos usando Apigee Edge (Clásico)</h5>
                </div>
                <p class="mb-3">Este curso está basado en <strong>Apigee Edge</strong>, la versión clásica de la plataforma que Google aún mantiene y es ampliamente utilizada en el enterprise. Reconocerás la interfaz por su característico <strong>color naranja</strong> y su arquitectura on-premise/híbrida.</p>
                
                <div class="row g-3">
                    <div class="col-lg-6">
                        <div class="p-3 bg-light rounded">
                            <h6 class="fw-bold text-primary"><i class="bi bi-building me-2"></i>Apigee Edge (Clásico) - Lo que usamos</h6>
                            <ul class="small mb-0">
                                <li><strong>UI Naranja:</strong> Interfaz clásica con diseño distintivo</li>
                                <li><strong>On-Premise/Híbrido:</strong> Puede desplegarse en tus servidores</li>
                                <li><strong>Gestión por Organización:</strong> Estructura tradicional</li>
                                <li><strong>Management Server:</strong> Arquitectura basada en servidores</li>
                                <li><strong>Políticas XML:</strong> Configuración tradicional</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="p-3 bg-light rounded">
                            <h6 class="fw-bold text-success"><i class="bi bi-cloud me-2"></i>Apigee X (Nuevo) - La evolución</h6>
                            <ul class="small mb-0">
                                <li><strong>UI Moderna:</strong> Diseño Material basado en GCP</li>
                                <li><strong>100% Cloud:</strong> Solo en Google Cloud Platform</li>
                                <li><strong>Gestión por Proyecto:</strong> Integrado con GCP</li>
                                <li><strong>Serverless:</strong> Sin gestión de infraestructura</li>
                                <li><strong>YAML + UI:</strong> Configuración modernizada</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="mt-3">
                    <small class="text-muted">
                        <strong>💡 Nota:</strong> Los conceptos fundamentales (proxies, políticas, flows) son idénticos entre versiones. Solo cambia la interfaz y el modelo de despliegue.
                    </small>
                </div>
            </div>
            
            <div class="row g-4">
                <div class="col-md-6 col-lg-3">
                    <div class="feature-card">
                        <div class="icon"><i class="bi bi-shield-check"></i></div>
                        <h5 class="card-title fw-bold">Seguridad</h5>
                        <p class="card-text small">Protege tus APIs con OAuth, API Keys y políticas contra amenazas, actuando como el guardia de seguridad.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="feature-card">
                        <div class="icon"><i class="bi bi-cone-striped"></i></div>
                        <h5 class="card-title fw-bold">Control de Tráfico</h5>
                        <p class="card-text small">Gestiona el flujo con cuotas y límites para evitar la saturación, como un controlador de tráfico aéreo.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="feature-card">
                        <div class="icon"><i class="bi bi-bar-chart-line-fill"></i></div>
                        <h5 class="card-title fw-bold">Análisis</h5>
                        <p class="card-text small">Obtén visibilidad del uso y rendimiento de tus APIs para tomar decisiones informadas.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="feature-card">
                        <div class="icon"><i class="bi bi-people-fill"></i></div>
                        <h5 class="card-title fw-bold">Gestión de Devs</h5>
                        <p class="card-text small">Facilita la adopción de tus APIs con portales de desarrolladores y documentación clara.</p>
                    </div>
                </div>
            </div>
        </section>

        <hr class="section-separator">

        <!-- Sección: Diferencias Edge vs Apigee X -->
        <section id="diferencias-versiones">
            <div class="module-card">
                <div class="module-header">
                    <div class="module-number">🔄</div>
                    <h2 class="m-0">Edge Clásico vs Apigee X: Diferencias Clave</h2>
                </div>
                
                <p class="lead mb-4">Aunque los conceptos fundamentales son idénticos, existen diferencias importantes en la experiencia de usuario, arquitectura y modelo de despliegue.</p>
                
                <div class="row g-4">
                    <!-- Interfaz de Usuario -->
                    <div class="col-lg-6">
                        <div class="card h-100 border-warning">
                            <div class="card-header bg-warning text-dark fw-bold">
                                <i class="bi bi-display me-2"></i>Interfaz de Usuario
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-12">
                                        <h6 class="text-primary fw-bold">🔶 Apigee Edge (Actual)</h6>
                                        <ul class="small">
                                            <li>Interfaz naranja distintiva</li>
                                            <li>Navegación por pestañas tradicionales</li>
                                            <li>Editor XML integrado para políticas</li>
                                            <li>Trace tool con vista detallada</li>
                                            <li>Analytics con dashboards clásicos</li>
                                        </ul>
                                    </div>
                                    <div class="col-12">
                                        <h6 class="text-success fw-bold">🔷 Apigee X (Nuevo)</h6>
                                        <ul class="small">
                                            <li>Diseño Material moderno (blanco/azul)</li>
                                            <li>Navegación lateral estilo GCP</li>
                                            <li>Editor visual + YAML</li>
                                            <li>Debug mejorado con live tracing</li>
                                            <li>Analytics integrados con GCP</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Arquitectura -->
                    <div class="col-lg-6">
                        <div class="card h-100 border-info">
                            <div class="card-header bg-info text-white fw-bold">
                                <i class="bi bi-diagram-3 me-2"></i>Arquitectura y Despliegue
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-12">
                                        <h6 class="text-primary fw-bold">🔶 Apigee Edge</h6>
                                        <ul class="small">
                                            <li><strong>Híbrido/On-premise:</strong> Flexibilidad total</li>
                                            <li><strong>Management Server:</strong> Administración centralizada</li>
                                            <li><strong>Message Processor:</strong> Runtime separado</li>
                                            <li><strong>Cassandra:</strong> Base de datos analytics</li>
                                            <li><strong>Control de infraestructura</strong></li>
                                        </ul>
                                    </div>
                                    <div class="col-12">
                                        <h6 class="text-success fw-bold">🔷 Apigee X</h6>
                                        <ul class="small">
                                            <li><strong>100% Cloud:</strong> Solo Google Cloud</li>
                                            <li><strong>Serverless:</strong> Sin gestión de servidores</li>
                                            <li><strong>Auto-scaling:</strong> Escalado automático</li>
                                            <li><strong>BigQuery:</strong> Analytics nativo GCP</li>
                                            <li><strong>Managed service completo</strong></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Características Técnicas -->
                    <div class="col-lg-6">
                        <div class="card h-100 border-success">
                            <div class="card-header bg-success text-white fw-bold">
                                <i class="bi bi-gear me-2"></i>Características Técnicas
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-12">
                                        <h6 class="text-primary fw-bold">🔶 Apigee Edge</h6>
                                        <ul class="small">
                                            <li><strong>Organizaciones:</strong> Estructura tradicional</li>
                                            <li><strong>Entornos:</strong> test, prod, etc.</li>
                                            <li><strong>Virtual Hosts:</strong> Configuración manual</li>
                                            <li><strong>TLS:</strong> Certificados manuales</li>
                                            <li><strong>Monetización:</strong> Módulo separado</li>
                                        </ul>
                                    </div>
                                    <div class="col-12">
                                        <h6 class="text-success fw-bold">🔷 Apigee X</h6>
                                        <ul class="small">
                                            <li><strong>Proyectos GCP:</strong> Integración nativa</li>
                                            <li><strong>Instances:</strong> Concepto simplificado</li>
                                            <li><strong>Load Balancers:</strong> GCP automático</li>
                                            <li><strong>TLS:</strong> Google-managed certificates</li>
                                            <li><strong>Monetización:</strong> Incluida por defecto</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Migración y Compatibilidad -->
                    <div class="col-lg-6">
                        <div class="card h-100 border-secondary">
                            <div class="card-header bg-secondary text-white fw-bold">
                                <i class="bi bi-arrow-left-right me-2"></i>Migración y Compatibilidad
                            </div>
                            <div class="card-body">
                                <h6 class="fw-bold text-info mb-3">📋 Aspectos Clave de Migración</h6>
                                <ul class="small">
                                    <li><strong>Proxies:</strong> Se migran automáticamente</li>
                                    <li><strong>Políticas:</strong> 100% compatibles</li>
                                    <li><strong>Configuración:</strong> Requiere adaptación</li>
                                    <li><strong>Integrations:</strong> Nuevas APIs GCP</li>
                                    <li><strong>Monitoring:</strong> Cambia a Cloud Monitoring</li>
                                    <li><strong>DevPortal:</strong> Drupal → Integrated Portal</li>
                                </ul>
                                
                                <div class="alert alert-light mt-3 p-2">
                                    <small><strong>🎯 Para el Aprendizaje:</strong> Los conceptos que aprendas en Edge son 100% aplicables a Apigee X. Solo cambia dónde haces clic.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 p-4 strategic-recommendation">
                    <h5 class="fw-bold mb-3"><i class="bi bi-lightbulb-fill text-warning me-2"></i>Recomendación Estratégica</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <h6 class="text-success">✅ Mantente en Edge si:</h6>
                            <ul class="small">
                                <li>Necesitas control total de infraestructura</li>
                                <li>Tienes integraciones complejas on-premise</li>
                                <li>Regulaciones requieren datos locales</li>
                                <li>El costo cloud es prohibitivo</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">🚀 Considera Apigee X si:</h6>
                            <ul class="small">
                                <li>Quieres eliminar gestión de infraestructura</li>
                                <li>Necesitas escalado automático</li>
                                <li>Buscas integración nativa con GCP</li>
                                <li>Prefieres un modelo fully-managed</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="section-separator">

        <!-- Asistente AI -->
        <section id="asistente-ai">
             <div class="card p-4 p-md-5">
                <div class="card-body text-center">
                    <i class="bi bi-robot mb-3" style="font-size: 4rem; color: #6FB1FC;"></i>
                    <h2 class="card-title mb-3 text-white">Asistente de Conceptos AI</h2>
                    <p class="card-text text-white-50 mx-auto" style="max-width: 600px;">¿Atascado en un término? Ingresa cualquier concepto de Apigee y obtén una explicación clara y concisa al instante.</p>
                    
                    <div class="row justify-content-center mt-4">
                        <div class="col-lg-8">
                             <div class="input-group mb-3">
                                <span class="input-group-text bg-dark border-secondary text-white"><i class="bi bi-search"></i></span>
                                <input type="text" class="form-control form-control-lg" id="ai-concept-input" placeholder="Ej: ¿Qué es un API Proxy?">
                            </div>
                             <div class="mb-4">
                                <small class="d-block mb-2 text-white-50">O intenta con estos ejemplos:</small>
                                <div class="d-flex flex-wrap justify-content-center gap-2">
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('API Proxy')">API Proxy</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('Reverse Proxy')">Reverse Proxy</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('API Products')">API Products</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('Developer Apps')">Developer Apps</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('KVM')">KVM</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('Target Servers')">Target Servers</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('Shared Flow')">Shared Flow</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('OAS')">OAS</button>
                                    <button class="btn btn-sm btn-outline-light" onclick="setExampleQuery('Virtual Host')">Virtual Host</button>
                                </div>
                            </div>
                            <button class="btn btn-primary-gradient btn-lg" id="ai-assistant-btn" onclick="handleAsistenteClick()">
                                <span id="ai-btn-text"><i class="bi bi-stars me-2"></i> Explicar Concepto</span>
                                <span id="ai-btn-spinner" class="spinner-border spinner-border-sm d-none ms-2" role="status" aria-hidden="true"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="section-separator">

        <!-- Concepto Fundamental: ¿Qué es una API? -->
        <section id="que-es-api">
            <div class="module-card">
                <div class="module-header">
                    <div class="module-number">💡</div>
                    <h2 class="m-0">Concepto Fundamental: ¿Qué es una API?</h2>
                </div>
                
                <div class="concept-box">
                    <h4><i class="bi bi-lightbulb-fill text-primary me-2"></i>Definición Simple</h4>
                    <p>Una <strong>API (Application Programming Interface)</strong> es una interfaz que permite que una aplicación "consuma" las funciones o datos de otra aplicación. Es como un <strong>mesero en un restaurante</strong>: tú le dices qué quieres (solicitud), él va a la cocina (sistema backend) y te trae tu pedido (respuesta).</p>
                </div>

                <div class="row g-4 mt-4">
                    <div class="col-lg-6">
                        <div class="p-4 border rounded h-100 bg-light-blue">
                            <h5 class="fw-bold"><i class="bi bi-puzzle me-2 text-primary"></i>¿Cómo Funciona?</h5>
                            <ul class="mb-0">
                                <li><strong>Puntos de entrada estables:</strong> Define formas consistentes de acceder a datos y funciones</li>
                                <li><strong>Reutilización:</strong> Los desarrolladores pueden usar lógica creada por otros</li>
                                <li><strong>Abstracción:</strong> Oculta la complejidad interna del sistema</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="p-4 border rounded h-100 bg-light-blue">
                            <h5 class="fw-bold"><i class="bi bi-handshake me-2 text-primary"></i>El "Contrato" de la API</h5>
                            <p class="mb-0">Las APIs implican un <strong>contrato</strong> que garantiza que los cambios serán predecibles y controlados. Esto da tranquilidad a los desarrolladores que las consumen, sabiendo que sus aplicaciones no se "romperán" de un día para otro.</p>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info mt-4">
                    <i class="bi bi-info-circle-fill me-2"></i>
                    <strong>¿Dónde entra Apigee?</strong> Apigee Edge te permite crear nuevas APIs o tomar APIs existentes y exponerlas con una capa adicional de <strong>administración, seguridad y visibilidad</strong>. También puedes convertir servicios web tradicionales (como servicios SOA) en APIs modernas.
                </div>
            </div>
        </section>

        <hr class="section-separator">

        <!-- Módulo 1: Creación -->
        <section id="creacion">
            <div class="module-card">
                <div class="module-header">
                    <div class="module-number">1</div>
                    <h2 class="m-0">Creando tu Primer API Proxy</h2>
                </div>
                
                <div class="concept-box">
                    <h4><i class="bi bi-lightbulb-fill text-primary me-2"></i>Concepto Clave: ¿Qué es un API Proxy?</h4>
                    <p>Un <strong>API Proxy</strong> es el componente fundamental en Apigee. No es el servicio de backend en sí, sino una <strong>fachada o una "puerta de entrada" digital</strong> que se coloca frente a tus servicios existentes. Actúa como un intermediario que desacopla la interfaz que expones a los desarrolladores (el frontend del API) de tu implementación de backend.</p>
                    <p>Piénsalo como el recepcionista de un hotel: los huéspedes (desarrolladores) interactúan con el recepcionista, no directamente con las habitaciones (servicios de backend). El recepcionista gestiona el acceso, proporciona información y asegura que todo funcione sin problemas. De manera similar, el API Proxy te permite añadir seguridad, transformar datos y monitorear el tráfico sin tocar tu código original.</p>
                </div>

                <!-- Definición Técnica Completa -->
                <div class="mt-4 p-4 bg-light rounded border">
                    <h5 class="fw-bold mb-3"><i class="bi bi-info-circle-fill text-primary me-2"></i>¿Qué es un Proxy de API en Profundidad?</h5>
                    <p class="mb-3">Para exponer las API en Apigee Edge, debe implementar <strong>proxies de API</strong>. Los proxies de API separan la API orientada a la aplicación de sus servicios de backend, lo que protege a esas aplicaciones de los cambios en el código de backend. Aunque haga cambios de backend en sus servicios, las aplicaciones seguirán llamando a la misma API sin ninguna interrupción.</p>
                    
                    <p class="mb-3">En una configuración de proxy de API, hay <strong>dos tipos de extremos fundamentales</strong>:</p>
                    
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="p-3 border rounded bg-white">
                                <h6 class="fw-bold text-primary mb-2"><i class="bi bi-arrow-right-circle-fill me-2"></i>ProxyEndpoint</h6>
                                <p class="small mb-0">Define la manera en que las apps cliente consumen tus API. Configura el ProxyEndpoint para definir la URL de tu proxy de API y determina si las apps acceden al proxy mediante HTTP o HTTPS. Aquí se aplican políticas de seguridad, verificaciones de cuotas y controles de acceso.</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-3 border rounded bg-white">
                                <h6 class="fw-bold text-success mb-2"><i class="bi bi-arrow-left-circle-fill me-2"></i>TargetEndpoint</h6>
                                <p class="small mb-0">Define la forma en que el proxy de API interactúa con tus servicios de backend. Configura el TargetEndpoint para reenviar solicitudes al servicio backend adecuado, incluyendo configuración de seguridad, protocolos y información de conexión.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sección de Visualización de Proxies -->
                <div class="mt-4">
                    <div class="strategic-recommendation p-4">
                        <h5 class="mb-3"><i class="bi bi-eye-fill text-primary me-2"></i>Visualización de los Proxies de API</h5>
                        
                        <p class="mb-3">Antes de crear tu primer proxy, es importante entender visualmente cómo funciona la arquitectura. Puedes visualizar los proxies de API como se muestra en el diagrama arquitectónico de referencia:</p>
                        
                        <!-- Imagen del Modelo Arquitectónico -->
                        <div class="text-center mb-4">
                            <img src="img/ApigeeProxyModel_v1.png" 
                                 alt="Diagrama del Modelo de API Proxy en Apigee Edge mostrando el flujo desde Cliente HTTP hasta Servicio Backend" 
                                 class="img-fluid rounded shadow-sm"
                                 style="max-width: 100%; height: auto; border: 1px solid var(--border-color);">
                            <div class="mt-2">
                                <small class="text-muted">
                                    <strong>Figura 1:</strong> Modelo arquitectónico del API Proxy mostrando el flujo completo: Cliente HTTP → ProxyEndpoint → TargetEndpoint → Servicio Backend
                                </small>
                            </div>
                        </div>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-lg-4">
                                <div class="text-center p-3 border rounded">
                                    <i class="bi bi-phone-fill fs-2 text-primary mb-2"></i>
                                    <h6 class="text-primary">Cliente HTTP</h6>
                                    <small class="text-muted">Aplicación móvil, web, o sistema que consume la API</small>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="text-center p-3 border rounded bg-light">
                                    <i class="bi bi-shield-fill-check fs-2 text-success mb-2"></i>
                                    <h6 class="text-success">API Proxy en Edge</h6>
                                    <small class="text-muted">Punto de entrada que gestiona seguridad, transformaciones y enrutamiento</small>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="text-center p-3 border rounded">
                                    <i class="bi bi-cloud-fill fs-2 text-info mb-2"></i>
                                    <h6 class="text-info">Servicio HTTP</h6>
                                    <small class="text-muted">Tu servicio backend real donde reside la lógica de negocio</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-info mb-0">
                            <h6 class="text-primary"><i class="bi bi-diagram-2-fill me-2"></i>Flujo de Comunicación</h6>
                            <p class="mb-2">El modelo <strong>ApigeeProxyModel_v1</strong> ilustra perfectamente esta separación de responsabilidades:</p>
                            <ul class="mb-0 small">
                                <li><strong>Request:</strong> Cliente → ProxyEndpoint (seguridad, validación) → TargetEndpoint (transformación) → Backend</li>
                                <li><strong>Response:</strong> Backend → TargetEndpoint (formato) → ProxyEndpoint (headers, cache) → Cliente</li>
                                <li><strong>Beneficio clave:</strong> Los cambios en backend no afectan a los clientes gracias a la capa de abstracción del proxy</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Métodos de Creación de Proxies -->
                <div class="mt-4 p-4 bg-white border rounded">
                    <h5 class="fw-bold mb-3"><i class="bi bi-gear-fill text-primary me-2"></i>¿Cómo se crea un Proxy de API?</h5>
                    <p class="mb-3">Un proxy de API consta de un <strong>paquete de archivos de configuración XML y código</strong> (como JavaScript y Java). Apigee proporciona varias formas de crear proxies de API:</p>
                    
                    <div class="row g-3">
                        <div class="col-lg-6">
                            <div class="p-3 border rounded bg-light">
                                <h6 class="fw-bold text-primary mb-2"><i class="bi bi-display me-2"></i>Interfaz Gráfica (GUI)</h6>
                                <p class="small mb-0">Usa la <strong>UI de administración de Edge</strong> para definir un proxy en una interfaz gráfica intuitiva. Es el método más común y amigable para principiantes.</p>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="p-3 border rounded bg-light">
                                <h6 class="fw-bold text-success mb-2"><i class="bi bi-file-earmark-code me-2"></i>Archivos XML</h6>
                                <p class="small mb-0">Creación manual de <strong>archivos XML de configuración</strong> junto con otros archivos compatibles, y luego importarlos a Edge.</p>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="p-3 border rounded bg-light">
                                <h6 class="fw-bold text-info mb-2"><i class="bi bi-cloud-arrow-up me-2"></i>API de Administración</h6>
                                <p class="small mb-0">Uso de la <strong>API de administración de Edge</strong> para crear proxies mediante solicitudes REST programáticas.</p>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="p-3 border rounded bg-light">
                                <h6 class="fw-bold text-warning mb-2"><i class="bi bi-code-square me-2"></i>Aplicación Node.js</h6>
                                <p class="small mb-0">Implementa una <strong>aplicación de Node.js</strong> como proxy independiente para casos de uso específicos.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-primary mt-3 mb-0">
                        <i class="bi bi-lightbulb me-2"></i>
                        <strong>Recomendación:</strong> Para este curso, nos enfocaremos en el <strong>método GUI</strong> ya que es el más intuitivo y utilizado en entornos empresariales.
                    </div>
                </div>

                <div class="p-4 rounded bg-light-blue mt-4">
                    <h5 class="fw-bold"><i class="bi bi-signpost-split-fill me-2 text-primary"></i>Pasos para Creación en Apigee Edge Clásico</h5>
                    <ol class="list-group list-group-numbered">
                        <li class="list-group-item border-0 bg-transparent">
                            <strong>Acceso y Navegación:</strong> Ingresa a tu Management Server de Apigee Edge (interfaz naranja) y navega a <code>APIs > API Proxies</code>, luego haz clic en <code>+ API Proxy</code>.
                        </li>
                        <li class="list-group-item border-0 bg-transparent">
                            <strong>Tipo de Proxy:</strong> Selecciona <strong>"Reverse Proxy"</strong>, el más común para empezar.
                            <div class="concept-box mt-2 p-3">
                                <h6><i class="bi bi-info-circle-fill text-primary me-2"></i>¿Qué es un Reverse Proxy?</h6>
                                <p class="small mb-0">Es un tipo de servidor que se sienta frente a los servidores web/aplicaciones y reenvía las solicitudes de los clientes a esos servidores. Para el cliente, el reverse proxy parece ser el servidor de origen. Es el patrón más común en Apigee porque permite centralizar la gestión y la seguridad de múltiples servicios de backend.</p>
                            </div>
                        </li>
                        <li class="list-group-item border-0 bg-transparent">
                            <strong>Configuración de Detalles:</strong> En Apigee Edge verás campos como:
                            <ul class="mt-2 small">
                                <li><strong>Proxy Name:</strong> Ej. <code>users-api-v1</code></li>
                                <li><strong>Proxy Base Path:</strong> Ej. <code>/v1/users</code></li>
                                <li><strong>Existing API:</strong> URL de tu backend</li>
                                <li><strong>Description:</strong> Documentación del proxy</li>
                            </ul>
                        </li>
                        <li class="list-group-item border-0 bg-transparent">
                            <strong>Selección de Entorno:</strong> En Edge clásico tendrás entornos como 'test', 'prod', etc. Selecciona donde desplegar.
                        </li>
                        <li class="list-group-item border-0 bg-transparent">
                            <strong>Virtual Hosts:</strong> Edge te permite seleccionar Virtual Hosts específicos (secure, default) para el despliegue.
                        </li>
                        <li class="list-group-item border-0 bg-transparent">
                            <strong>Deploy:</strong> Haz clic en "Build and Deploy" y ¡tu proxy estará vivo en segundos!
                        </li>
                    </ol>
                    
                    <div class="alert alert-info mt-3">
                        <i class="bi bi-lightbulb me-2"></i>
                        <strong>Diferencia con Apigee X:</strong> En la nueva versión, estos pasos se simplifican con una UI más moderna y menos opciones de configuración manual, pero los conceptos son idénticos.
                    </div>
                </div>

                <!-- Ejemplo Visual: Creación de Proxy en Apigee Edge -->
                <div class="mt-5 p-4 strategic-recommendation">
                    <h5 class="fw-bold mb-4"><i class="bi bi-images text-primary me-2"></i>Ejemplo Visual: Creando un Reverse Proxy en Apigee Edge</h5>
                    <p class="mb-4">A continuación verás el flujo real de creación de un API Proxy en la interfaz de Apigee Edge clásico. Estas capturas muestran el proceso paso a paso desde la selección del tipo hasta el despliegue final.</p>
                    
                    <!-- Imágenes del Proceso Build a Proxy -->
                    <div class="row g-3 mb-4">
                        <div class="col-lg-6 mb-4">
                            <div class="text-center">
                                <div class="image-container" style="height: 350px; width: 100%; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden; position: relative;">
                                    <img src="img/BuildProxy.png" 
                                         alt="Pantalla de selección de tipo de proxy en Apigee Edge mostrando Reverse proxy seleccionado" 
                                         class="shadow-sm"
                                         style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 1:</strong> TYPE - Selección del tipo de proxy</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 mb-4">
                            <div class="text-center">
                                <div class="image-container" style="height: 350px; width: 100%; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden; position: relative;">
                                    <img src="img/BuildProxyDetails.png" 
                                         alt="Formulario de detalles del proxy con campos Proxy Name, Base Path, Existing API y Description" 
                                         class="shadow-sm"
                                         style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 2:</strong> DETAILS - Configuración de detalles</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 mb-4">
                            <div class="text-center">
                                <div class="image-container" style="height: 350px; width: 100%; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden; position: relative;">
                                    <img src="img/BuildProxySecurity.png" 
                                         alt="Opciones de seguridad con OAuth 2.0 seleccionado y checkboxes para cuotas y API product" 
                                         class="shadow-sm"
                                         style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 3:</strong> SECURITY - Configuración de seguridad</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 mb-4">
                            <div class="text-center">
                                <div class="image-container" style="height: 350px; width: 100%; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden; position: relative;">
                                    <img src="img/BuildProxyVirtualHost.png" 
                                         alt="Tabla de Virtual Hosts mostrando VHost-Secure seleccionado con HTTPS habilitado" 
                                         class="shadow-sm"
                                         style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 4:</strong> VIRTUAL HOSTS - Selección de puntos de entrada</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 mb-4">
                            <div class="text-center">
                                <div class="image-container mx-auto" style="height: 350px; width: 70%; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden; position: relative;">
                                    <img src="img/BuildProxyBuildAndDeploy.png" 
                                         alt="Pantalla final de BUILD mostrando resumen del proxy y botón Build and Deploy" 
                                         class="shadow-sm"
                                         style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 5:</strong> BUILD - Resumen final y despliegue</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Paso 1: Selección de Tipo -->
                    <div class="row mb-4">
                        <div class="col-lg-6">
                            <div class="text-center">
                                <div class="bg-white border rounded p-4 shadow-sm" style="min-height: 300px;">
                                    <div class="bg-warning text-dark p-2 rounded mb-3">
                                        <strong>🔶 Build a Proxy - TYPE</strong>
                                    </div>
                                    <div class="text-start">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="radio" checked disabled>
                                            <label class="form-check-label fw-bold text-primary">
                                                🔵 Reverse proxy (most common)
                                            </label>
                                            <div class="small text-muted ms-3">Route inbound requests to backend services.</div>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="radio" disabled>
                                            <label class="form-check-label">
                                                SOAP service
                                            </label>
                                            <div class="small text-muted ms-3">Create a RESTful or pass-through proxy for a SOAP service.</div>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="radio" disabled>
                                            <label class="form-check-label">
                                                No Target
                                            </label>
                                            <div class="small text-muted ms-3">Create a simple API proxy that does not route to any backend target.</div>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="radio" disabled>
                                            <label class="form-check-label">
                                                Proxy bundle
                                            </label>
                                            <div class="small text-muted ms-3">Import an existing proxy from a zip archive.</div>
                                        </div>
                                        <div class="small text-muted mt-3">
                                            <span class="text-warning">Node.js App</span> - deprecated as per the Trireme EOL
                                        </div>
                                    </div>
                                    <div class="mt-3 d-flex justify-content-end">
                                        <button class="btn btn-primary btn-sm" disabled>Next</button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 1:</strong> Selección del Tipo de Proxy</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="p-3 bg-light rounded h-100 d-flex flex-column justify-content-center">
                                <h6 class="fw-bold text-primary mb-3"><i class="bi bi-1-square-fill me-2"></i>TYPE: Elegir el Tipo de Proxy</h6>
                                <ul class="mb-3">
                                    <li><strong>🔵 Reverse proxy (most common):</strong> La opción seleccionada - redirige solicitudes a servicios backend</li>
                                    <li><strong>SOAP service:</strong> Para servicios web SOAP tradicionales</li>
                                    <li><strong>No Target:</strong> Proxy sin backend (para mocking o datos estáticos)</li>
                                    <li><strong>Proxy bundle:</strong> Importar un proxy existente desde archivo ZIP</li>
                                </ul>
                                <div class="alert alert-success mb-0">
                                    <small><i class="bi bi-check-circle me-2"></i><strong>Observa</strong> que "Reverse proxy" está seleccionado por defecto porque es el patrón más común para APIs REST.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Paso 2: Detalles del Proxy -->
                    <div class="row mb-4">
                        <div class="col-lg-6">
                            <div class="p-3 bg-light rounded h-100 d-flex flex-column justify-content-center">
                                <h6 class="fw-bold text-primary mb-3"><i class="bi bi-2-square-fill me-2"></i>DETAILS: Configurar los Detalles</h6>
                                <ul class="mb-3">
                                    <li><strong>Proxy Name:</strong> <code>Api-Proxy-Debtmanagement-2</code> - Nombre único del proxy</li>
                                    <li><strong>Proxy Base Path:</strong> <code>/debtmanagement/v1</code> - URL pública del API</li>
                                    <li><strong>Existing API:</strong> URL del servicio backend real</li>
                                    <li><strong>Description:</strong> <code>Prueba</code> - Documentación del proxy</li>
                                </ul>
                                <div class="alert alert-info mb-0">
                                    <small><i class="bi bi-info-circle me-2"></i>El <strong>Base Path</strong> es lo que verán los clientes. El backend puede estar en una URL completamente diferente.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="text-center">
                                <div class="bg-white border rounded p-4 shadow-sm" style="min-height: 300px;">
                                    <div class="bg-info text-white p-2 rounded mb-3">
                                        <strong>🔷 Build a Proxy - DETAILS</strong>
                                    </div>
                                    <div class="text-start">
                                        <div class="mb-3">
                                            <label class="form-label fw-bold small">Proxy Name *</label>
                                            <input type="text" class="form-control form-control-sm" value="Api-Proxy-Debtmanagement-2" disabled>
                                            <div class="small text-muted">Valid characters are letters, numbers, dash (-), and underscore (_).</div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label fw-bold small">Proxy Base Path *</label>
                                            <input type="text" class="form-control form-control-sm" value="/debtmanagement/v1" disabled>
                                            <div class="small text-muted">A path component that uniquely identifies this API proxy.</div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label fw-bold small">Existing API *</label>
                                            <input type="text" class="form-control form-control-sm" value="https://claro-backend-capa-digital.apps.aro-dev.conecel.com" disabled>
                                            <div class="small text-muted">Defines the target URL invoked on behalf of this API proxy.</div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label fw-bold small">Description</label>
                                            <input type="text" class="form-control form-control-sm" value="Prueba" disabled>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button class="btn btn-secondary btn-sm" disabled>Previous</button>
                                        <button class="btn btn-primary btn-sm" disabled>Next</button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 2:</strong> Configuración de Detalles</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Paso 3: Seguridad -->
                    <div class="row mb-4">
                        <div class="col-lg-6">
                            <div class="text-center">
                                <div class="bg-white border rounded p-4 shadow-sm" style="min-height: 280px;">
                                    <div class="bg-success text-white p-2 rounded mb-3">
                                        <strong>🔐 Build a Proxy - SECURITY</strong>
                                    </div>
                                    <div class="text-start">
                                        <p class="small mb-3">Secure access for users and clients.</p>
                                        
                                        <div class="mb-2"><strong>Authorization</strong></div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" disabled>
                                            <label class="form-check-label">Pass through (none)</label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" disabled>
                                            <label class="form-check-label">API key</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="radio" checked disabled>
                                            <label class="form-check-label fw-bold text-primary">OAuth 2.0</label>
                                        </div>
                                        
                                        <div class="ms-3 mb-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked disabled>
                                                <label class="form-check-label small">Impose Quota Per Developer</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked disabled>
                                                <label class="form-check-label small">Publish API Product</label>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-2"><strong>Browser</strong></div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" disabled>
                                            <label class="form-check-label small">Add CORS headers</label>
                                        </div>
                                        
                                        <div class="mb-2"><strong>Monetization</strong></div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" disabled>
                                            <label class="form-check-label small">Enable Monetization Limits Check</label>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between mt-3">
                                        <button class="btn btn-secondary btn-sm" disabled>Previous</button>
                                        <button class="btn btn-primary btn-sm" disabled>Next</button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 3:</strong> Configuración de Seguridad</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="p-3 bg-light rounded h-100 d-flex flex-column justify-content-center">
                                <h6 class="fw-bold text-primary mb-3"><i class="bi bi-3-square-fill me-2"></i>SECURITY: Configurar la Seguridad</h6>
                                <ul class="mb-3">
                                    <li><strong>OAuth 2.0 seleccionado:</strong> Autenticación robusta con tokens</li>
                                    <li><strong>Impose Quota Per Developer:</strong> Límites automáticos por desarrollador</li>
                                    <li><strong>Publish API Product:</strong> Crea automáticamente un producto para el proxy</li>
                                </ul>
                                <div class="alert alert-warning mb-0">
                                    <small><i class="bi bi-shield-check me-2"></i>Estas opciones agregan automáticamente <strong>políticas de seguridad</strong> al proxy sin necesidad de configuración manual.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Paso 4: Virtual Hosts -->
                    <div class="row mb-4">
                        <div class="col-lg-6">
                            <div class="p-3 bg-light rounded h-100 d-flex flex-column justify-content-center">
                                <h6 class="fw-bold text-primary mb-3"><i class="bi bi-4-square-fill me-2"></i>VIRTUAL HOSTS: Seleccionar Puntos de Entrada</h6>
                                <ul class="mb-3">
                                    <li><strong>VHost-Secure (seleccionado):</strong> Acceso HTTPS seguro</li>
                                    <li><strong>VHost-prueba, VHost-OA-Default:</strong> Otros entornos disponibles</li>
                                    <li><strong>Host Aliases:</strong> Las URLs reales donde se accederá al proxy</li>
                                </ul>
                                <div class="alert alert-success mb-0">
                                    <small><i class="bi bi-globe me-2"></i>Los Virtual Hosts definen <strong>dónde y cómo</strong> los clientes pueden acceder a tu proxy (HTTP vs HTTPS, diferentes dominios).</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="text-center">
                                <div class="bg-white border rounded p-4 shadow-sm" style="min-height: 350px;">
                                    <div class="bg-primary text-white p-2 rounded mb-3">
                                        <strong>🌐 Build a Proxy - VIRTUAL HOSTS</strong>
                                    </div>
                                    <div class="text-start">
                                        <p class="small mb-3">Select the virtual hosts this proxy will bind to when it is deployed. You must select at least one virtual host.</p>
                                        
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th width="50"></th>
                                                        <th>Name</th>
                                                        <th>Environment</th>
                                                        <th>Host Aliases</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><input type="checkbox" class="form-check-input" disabled></td>
                                                        <td>default</td>
                                                        <td><span class="badge bg-secondary">dev</span></td>
                                                        <td class="small">http://api-proxy.gate.dev.conecel.com:9001</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" class="form-check-input" disabled></td>
                                                        <td>qa</td>
                                                        <td><span class="badge bg-warning">qa</span></td>
                                                        <td class="small">http://api-proxy.gate.qa.conecel.com:9001</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" class="form-check-input" disabled></td>
                                                        <td>VHost-prueba</td>
                                                        <td><span class="badge bg-secondary">dev</span></td>
                                                        <td class="small">http://10.225.13.94:9001, http://10.225.13.95:9001</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" class="form-check-input" disabled></td>
                                                        <td>VHost-OA-Default</td>
                                                        <td><span class="badge bg-secondary">dev</span></td>
                                                        <td class="small">http://api-proxy.gate.qa.conecel.com:9001</td>
                                                    </tr>
                                                    <tr class="table-success">
                                                        <td><input type="checkbox" class="form-check-input" checked disabled></td>
                                                        <td><strong>VHost-Secure</strong></td>
                                                        <td><span class="badge bg-secondary">dev</span></td>
                                                        <td class="small"><strong>https://api-proxy.gate.dev.conecel.com</strong></td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" class="form-check-input" disabled></td>
                                                        <td>Vhost-service</td>
                                                        <td><span class="badge bg-secondary">dev</span></td>
                                                        <td class="small">http://service.gate.dev.conecel.com:9001</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" class="form-check-input" disabled></td>
                                                        <td>VHost-Transforma</td>
                                                        <td><span class="badge bg-secondary">dev</span></td>
                                                        <td class="small">http://apis.dev.claro.com.ec:9001</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button class="btn btn-secondary btn-sm" disabled>Previous</button>
                                        <button class="btn btn-primary btn-sm" disabled>Next</button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 4:</strong> Selección de Virtual Hosts</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Paso 5: Build y Deploy -->
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="text-center">
                                <div class="bg-white border rounded p-4 shadow-sm" style="min-height: 320px;">
                                    <div class="bg-success text-white p-2 rounded mb-3">
                                        <strong>🚀 Build a Proxy - BUILD</strong>
                                    </div>
                                    <div class="text-start">
                                        <p class="mb-3">You are ready to build and deploy your API proxy.</p>
                                        
                                        <div class="mb-3">
                                            <strong class="small">Deploy Environments</strong>
                                            <div class="form-check mt-1">
                                                <input class="form-check-input" type="checkbox" checked disabled>
                                                <label class="form-check-label">
                                                    <span class="badge bg-secondary">dev</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-light p-3 rounded mb-3">
                                            <div class="row small">
                                                <div class="col-4"><strong>Proxy Name</strong></div>
                                                <div class="col-8">Api-Proxy-Debtmanagement-2</div>
                                            </div>
                                            <div class="row small">
                                                <div class="col-4"><strong>Proxy Type</strong></div>
                                                <div class="col-8">Reverse proxy</div>
                                            </div>
                                            <div class="row small">
                                                <div class="col-4"><strong>Virtual Hosts</strong></div>
                                                <div class="col-8">VHost-Secure</div>
                                            </div>
                                            <div class="row small">
                                                <div class="col-4"><strong>Security</strong></div>
                                                <div class="col-8">✓ Secure with OAuth v2.0 Access Tokens</div>
                                            </div>
                                            <div class="row small">
                                                <div class="col-4"><strong>Browser</strong></div>
                                                <div class="col-8">Do not allow direct requests from a browser via CORS</div>
                                            </div>
                                            <div class="row small">
                                                <div class="col-4"><strong>Monetization</strong></div>
                                                <div class="col-8">✗</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button class="btn btn-secondary btn-sm" disabled>Previous</button>
                                        <button class="btn btn-success btn-sm" disabled>
                                            <i class="bi bi-rocket-takeoff me-1"></i>Build and Deploy
                                        </button>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <small class="text-muted"><strong>Paso 5:</strong> Resumen y Despliegue</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="p-3 bg-light rounded h-100 d-flex flex-column justify-content-center">
                                <h6 class="fw-bold text-primary mb-3"><i class="bi bi-5-square-fill me-2"></i>BUILD: Resumen y Despliegue</h6>
                                <ul class="mb-3">
                                    <li><strong>Revisión final:</strong> Todos los parámetros configurados</li>
                                    <li><strong>Environment:</strong> "dev" seleccionado para despliegue</li>
                                    <li><strong>Build and Deploy:</strong> Crea y activa el proxy</li>
                                </ul>
                                <div class="alert alert-info mb-0">
                                    <small><i class="bi bi-lightning me-2"></i>Una vez hecho clic en <strong>"Build and Deploy"</strong>, tu proxy estará vivo y accesible en segundos a través de la URL configurada.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Resultado Final -->
                    <div class="mt-4 p-3 bg-success bg-opacity-10 border border-success rounded">
                        <h6 class="text-success fw-bold mb-2"><i class="bi bi-check-circle-fill me-2"></i>Resultado Final</h6>
                        <p class="mb-2">Después de completar estos pasos, tendrás:</p>
                        <ul class="mb-0 small">
                            <li>Un <strong>API Proxy funcional</strong> llamado "Api-Proxy-Debtmanagement-2"</li>
                            <li>Accesible vía <strong>HTTPS</strong> en: <code>https://api-proxy.gate.dev.conecel.com/debtmanagement/v1</code></li>
                            <li>Con <strong>seguridad OAuth 2.0</strong> habilitada automáticamente</li>
                            <li>Un <strong>API Product</strong> creado automáticamente para gestionar el acceso</li>
                            <li>Políticas de <strong>cuota por desarrollador</strong> aplicadas</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <hr class="section-separator">

        <!-- Concepto Fundamental: ¿Qué es una Política? -->
        <section id="que-es-politica">
            <div class="module-card">
                <div class="module-header">
                    <div class="module-number">⚙️</div>
                    <h2 class="m-0">Concepto Fundamental: ¿Qué es una Política?</h2>
                </div>
                
                <div class="concept-box">
                    <h4><i class="bi bi-gear-fill text-primary me-2"></i>Definición de Policy</h4>
                    <p>Edge te permite controlar el comportamiento de la API mediante <strong>policies</strong> y sin escribir código. Una política es como un <strong>módulo que implementa una función de administración limitada específica</strong> como parte del flujo de solicitud/respuesta del proxy.</p>
                </div>

                <div class="row g-4 mt-4">
                    <div class="col-lg-6">
                        <div class="p-4 border rounded h-100 bg-light-blue">
                            <h5 class="fw-bold"><i class="bi bi-puzzle-fill me-2 text-primary"></i>¿Cómo Funcionan?</h5>
                            <p class="mb-3">Las políticas están diseñadas para permitirte <strong>agregar tipos comunes de capacidades de administración</strong> a una API de forma fácil y confiable.</p>
                            <ul class="mb-0">
                                <li><strong>Seguridad</strong> - Autenticación y autorización</li>
                                <li><strong>Límites de frecuencia</strong> - Control de tráfico</li>
                                <li><strong>Transformación</strong> - Modificación de datos</li>
                                <li><strong>Mediación</strong> - Adaptación de protocolos</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="p-4 border rounded h-100 bg-light-blue">
                            <h5 class="fw-bold"><i class="bi bi-code-slash me-2 text-success"></i>Ventaja Principal</h5>
                            <p class="mb-0">Las políticas proporcionan estas funciones <strong>evitando que tengas que codificar y mantener esta funcionalidad por tu cuenta</strong>. Es como tener una biblioteca de componentes pre-construidos y probados que puedes ensamblar como bloques de construcción para crear el comportamiento deseado de tu API.</p>
                            
                            <div class="alert alert-success mt-3 mb-0">
                                <i class="bi bi-check-circle-fill me-2"></i>
                                <strong>Sin código = Menos errores + Mayor productividad</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 p-4 strategic-recommendation">
                    <h5 class="fw-bold mb-3"><i class="bi bi-lightbulb-fill text-warning me-2"></i>Analogía Práctica</h5>
                    <p class="mb-3">Imagina las políticas como <strong>filtros especializados en una fábrica</strong>:</p>
                    <div class="row g-3">
                        <div class="col-md-4 text-center">
                            <div class="p-3 bg-white rounded border">
                                <i class="bi bi-shield-check fs-2 text-primary mb-2"></i>
                                <h6>Filtro de Seguridad</h6>
                                <small class="text-muted">Solo deja pasar solicitudes con credenciales válidas</small>
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="p-3 bg-white rounded border">
                                <i class="bi bi-speedometer2 fs-2 text-warning mb-2"></i>
                                <h6>Filtro de Velocidad</h6>
                                <small class="text-muted">Controla cuántas solicitudes pasan por minuto</small>
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="p-3 bg-white rounded border">
                                <i class="bi bi-arrow-left-right fs-2 text-info mb-2"></i>
                                <h6>Filtro de Formato</h6>
                                <small class="text-muted">Convierte datos de un formato a otro</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="section-separator">
            <div class="module-card">
                <div class="module-header">
                    <div class="module-number">2</div>
                    <h2 class="m-0">Ecosistema y Componentes Clave</h2>
                </div>
                <p class="lead">Un proxy no opera de forma aislada. Apigee provee un ecosistema de componentes reutilizables para centralizar la configuración y la lógica.</p>
                <div class="row g-4 mt-4">
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card">
                            <div class="icon"><i class="bi bi-arrows-collapse"></i></div>
                            <h5 class="card-title fw-bold">Shared Flows</h5>
                            <p class="card-text small">Secuencias de políticas reutilizables (ej. seguridad). Se definen una vez y se "enganchan" a múltiples proxies.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card">
                            <div class="icon"><i class="bi bi-file-earmark-code"></i></div>
                            <h5 class="card-title fw-bold">OAS</h5>
                            <p class="card-text small">El "contrato" de tu API (OpenAPI Specification) para validar que las solicitudes cumplan con la estructura definida.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card">
                            <div class="icon"><i class="bi bi-key-fill"></i></div>
                            <h5 class="card-title fw-bold">KVMs</h5>
                            <p class="card-text small">Key-Value Maps para almacenar datos de configuración (URLs, credenciales) fuera del código del proxy.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card">
                            <div class="icon"><i class="bi bi-server"></i></div>
                            <h5 class="card-title fw-bold">Target Servers</h5>
                            <p class="card-text small">Abstracción para desacoplar la URL del backend del código, permitiendo configuración por ambiente.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card">
                            <div class="icon"><i class="bi bi-hdd-network-fill"></i></div>
                            <h5 class="card-title fw-bold">Virtual Hosts</h5>
                            <p class="card-text small">Definen el punto de entrada (dominio y puerto) por donde se accederá a los proxies.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="section-separator">

        <!-- Módulo 3: Estructura -->
        <section id="estructura">
             <div class="module-card">
                <div class="module-header">
                    <div class="module-number">3</div>
                    <h2 class="m-0">Anatomía de un API Proxy</h2>
                </div>
                
                <!-- Definición mejorada de API Proxy -->
                <div class="concept-box mb-4">
                    <h4><i class="bi bi-info-circle-fill text-primary me-2"></i>¿Qué es un Proxy de API en profundidad?</h4>
                    <p class="mb-3">Para exponer las API en Apigee Edge, debe implementar <strong>proxies de API</strong>. Los proxies de API separan la API orientada a la aplicación de sus servicios de backend, lo que protege a esas aplicaciones de los cambios en el código de backend. Aunque haga cambios de backend en sus servicios, las aplicaciones seguirán llamando a la misma API sin ninguna interrupción.</p>
                    
                    <div class="alert alert-info" role="alert">
                        <h6 class="alert-heading"><i class="bi bi-lightbulb-fill me-2"></i>Analogía Práctica</h6>
                        <p class="mb-0">Imagina el proxy como un <strong>traductor diplomático</strong> en una embajada: los visitantes (aplicaciones cliente) hablan con el traductor en su idioma, y este se comunica internamente con los funcionarios (servicios backend) en el idioma que ellos entienden. Si cambian los funcionarios o sus procedimientos, el traductor adapta la comunicación sin que los visitantes se den cuenta.</p>
                    </div>
                </div>

                <p class="lead">En una configuración de proxy de API, hay <strong>dos tipos de extremos fundamentales</strong> que trabajan juntos para crear una experiencia fluida:</p>
                
                <div class="row g-4 mt-4">
                    <div class="col-lg-6">
                        <div class="p-4 border rounded h-100">
                            <h5 class="fw-bold"><i class="bi bi-box-arrow-in-right me-2 text-primary"></i>ProxyEndpoint</h5>
                            <p class="mb-3"><strong>Define la manera en que las apps cliente consumen tus API.</strong> Configura ProxyEndpoint para definir la URL de tu proxy de API. El extremo del proxy también determina si las apps acceden al proxy de API a través de HTTP o HTTPS.</p>
                            <div class="small text-muted">
                                <strong>Funciones clave:</strong>
                                <ul class="mt-2">
                                    <li>Aplica seguridad y autenticación</li>
                                    <li>Verifica cuotas y límites de velocidad</li>
                                    <li>Controla el acceso y valida entrada</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                     <div class="col-lg-6">
                        <div class="p-4 border rounded h-100">
                            <h5 class="fw-bold"><i class="bi bi-bullseye me-2 text-primary"></i>TargetEndpoint</h5>
                            <p class="mb-3"><strong>Define la forma en que el proxy de API interactúa con tus servicios de backend.</strong> Puedes configurar el extremo de destino para reenviar solicitudes al servicio de backend adecuado, incluida la definición de cualquier configuración de seguridad, protocolo HTTP o HTTPS, y otra información de conexión.</p>
                            <div class="small text-muted">
                                <strong>Funciones clave:</strong>
                                <ul class="mt-2">
                                    <li>Transforma respuestas para el formato correcto</li>
                                    <li>Maneja conexiones y balanceo de carga</li>
                                    <li>Aplica políticas de formato y datos</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Diagrama conceptual -->
                <div class="mt-5 p-4 bg-light-blue rounded">
                    <h5 class="text-center mb-4"><i class="bi bi-diagram-3-fill text-primary me-2"></i>Flujo Visual del API Proxy</h5>
                    <div class="text-center">
                        <div class="d-inline-flex align-items-center mb-3">
                            <div class="px-3 py-2 bg-white border rounded me-3">
                                <i class="bi bi-phone-fill text-primary"></i><br>
                                <small><strong>Cliente HTTP</strong></small>
                            </div>
                            <i class="bi bi-arrow-right text-primary fs-4 me-3"></i>
                            <div class="px-3 py-2 bg-warning rounded me-3">
                                <i class="bi bi-box-arrow-in-right"></i><br>
                                <small><strong>ProxyEndpoint</strong></small>
                            </div>
                            <i class="bi bi-arrow-right text-primary fs-4 me-3"></i>
                            <div class="px-3 py-2 bg-info text-white rounded me-3">
                                <i class="bi bi-bullseye"></i><br>
                                <small><strong>TargetEndpoint</strong></small>
                            </div>
                            <i class="bi bi-arrow-right text-primary fs-4 me-3"></i>
                            <div class="px-3 py-2 bg-white border rounded">
                                <i class="bi bi-cloud-fill text-primary"></i><br>
                                <small><strong>Servicio Backend</strong></small>
                            </div>
                        </div>
                        <div class="small text-muted">
                            <strong>Request:</strong> Cliente → ProxyEndpoint → TargetEndpoint → Backend<br>
                            <strong>Response:</strong> Backend → TargetEndpoint → ProxyEndpoint → Cliente
                        </div>
                    </div>
                </div>
                
                <!-- Glosario de Términos XML -->
                <div class="mt-5">
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-book-fill me-2"></i>Glosario de Términos del XML</h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-4">
                                <div class="col-lg-6">
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-arrow-right-circle me-2"></i>PreFlow, PostFlow, Flows</h6>
                                        <p class="small mb-0">Son los contenedores de la lógica. <strong>PreFlow</strong> se ejecuta siempre al inicio. <strong>Flows</strong> se ejecutan si su condición se cumple. <strong>PostFlow</strong> se ejecuta siempre al final.</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-play-circle me-2"></i>Step</h6>
                                        <p class="small mb-0">Es un paso dentro de un flujo. Generalmente, contiene el nombre de una <strong>política</strong> (<code>&lt;Name&gt;</code>) para ser ejecutada. Por ejemplo: <code>&lt;Step&gt;&lt;Name&gt;fc-oauth-security&lt;/Name&gt;&lt;/Step&gt;</code> ejecuta la política llamada "fc-oauth-security".</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-exclamation-triangle me-2"></i>FaultRules</h6>
                                        <p class="small mb-0">Define un conjunto de pasos a seguir cuando ocurre un error específico, permitiendo un manejo de errores personalizado.</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-arrow-left-right me-2"></i>Request / Response</h6>
                                        <p class="small mb-0">Indican si los pasos dentro de un flujo se aplican a la solicitud entrante (<strong>Request</strong>) o a la respuesta saliente (<strong>Response</strong>).</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-question-circle me-2"></i>Condition</h6>
                                        <p class="small mb-0">Una expresión lógica que determina si un Flow (o un Step) debe ejecutarse. Por ejemplo, <code>(request.verb = "GET")</code>.</p>
                                    </div>
                                </div>
                                
                                <div class="col-lg-6">
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-globe me-2"></i>HTTPProxyConnection</h6>
                                        <p class="small mb-0">Define la interfaz pública del proxy, incluyendo el <code>BasePath</code> y el <code>VirtualHost</code>.</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-signpost me-2"></i>RouteRule</h6>
                                        <p class="small mb-0">Conecta el ProxyEndpoint con un TargetEndpoint específico. Puede tener condiciones para enrutar a diferentes backends.</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-hdd-network me-2"></i>HTTPTargetConnection</h6>
                                        <p class="small mb-0">Define la conexión con el servicio de backend, ya sea a través de una URL directa o un <code>LoadBalancer</code>.</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-diagram-3 me-2"></i>LoadBalancer / Server</h6>
                                        <p class="small mb-0">Permite balancear la carga entre múltiples instancias de backend, haciendo referencia a <strong>TargetServers</strong> preconfigurados.</p>
                                    </div>
                                    
                                    <div class="term-item mb-4">
                                        <h6 class="fw-bold text-primary"><i class="bi bi-folder me-2"></i>Path</h6>
                                        <p class="small mb-0">La ruta específica del servicio en el backend que se añadirá a la URL del TargetServer.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <div class="alert alert-info mb-4">
                        <h6><i class="bi bi-info-circle-fill me-2"></i>Conexión Importante: Políticas y XML</h6>
                        <p class="mb-0">Recuerda que las <strong>políticas</strong> que vimos en la sección anterior se invocan desde el XML del proxy mediante elementos <code>&lt;Step&gt;&lt;Name&gt;nombre-política&lt;/Name&gt;&lt;/Step&gt;</code>. Cada Step ejecuta una política específica que implementa funcionalidades como seguridad, transformación, etc.</p>
                    </div>
                    
                    <h5 class="fw-bold text-center my-4">Análisis del Código XML</h5>
                    <div class="accordion" id="accordionXml">
                        <!-- XML Proxy Endpoint -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingProxy">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProxy" aria-expanded="true" aria-controls="collapseProxy">
                                    <strong>XML del ProxyEndpoint: <code>default.xml</code></strong>
                                </button>
                            </h2>
                            <div id="collapseProxy" class="accordion-collapse collapse show" aria-labelledby="headingProxy">
                                <div class="accordion-body">
                                    <p>A continuación se detalla el XML que define el comportamiento del Proxy Endpoint. Observa cómo se organizan los <code>&lt;Step&gt;</code> (que ejecutan <strong>políticas específicas</strong>) dentro de los flujos <code>PreFlow</code>, <code>PostFlow</code> y <code>Flows</code> condicionales. Cada <code>&lt;Name&gt;</code> dentro de un Step corresponde a una política que implementa funcionalidades como OAuth, cuotas, logging, etc.</p>
                                    <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code><span class="xml-comment">&lt;!-- 
    El ProxyEndpoint define la interfaz pública del API.
    Maneja la lógica de cara al cliente.
--&gt;</span>
<span class="xml-tag">&lt;ProxyEndpoint</span> <span class="xml-attribute">name=</span><span class="xml-value">"default"</span><span class="xml-tag">&gt;</span>
    <span class="xml-tag">&lt;Description/&gt;</span>
    <span class="xml-tag">&lt;FaultRules&gt;</span>
        <span class="xml-comment">&lt;!-- Manejo de errores genéricos en el flujo del proxy --&gt;</span>
        <span class="xml-tag">&lt;FaultRule</span> <span class="xml-attribute">name=</span><span class="xml-value">"SimpleError"</span><span class="xml-tag">&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-failure-rules<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-log-builder<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span>
        <span class="xml-tag">&lt;/FaultRule&gt;</span>
    <span class="xml-tag">&lt;/FaultRules&gt;</span>
    <span class="xml-tag">&lt;PreFlow</span> <span class="xml-attribute">name=</span><span class="xml-value">"PreFlow"</span><span class="xml-tag">&gt;</span>
        <span class="xml-comment">&lt;!-- Se ejecuta para CADA solicitud entrante --&gt;</span>
        <span class="xml-tag">&lt;Request&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-uuid-time-generator<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Genera un ID único para tracking --&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-oauth-security<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Valida el token OAuth --&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>KVM-Debtmanagement<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Carga valores de un KVM --&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>q-debtmanagement-quota<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Aplica la cuota de uso --&gt;</span>
        <span class="xml-tag">&lt;/Request&gt;</span>
        <span class="xml-tag">&lt;Response/&gt;</span>
    <span class="xml-tag">&lt;/PreFlow&gt;</span>
    <span class="xml-tag">&lt;PostFlow</span> <span class="xml-attribute">name=</span><span class="xml-value">"PostFlow"</span><span class="xml-tag">&gt;</span>
        <span class="xml-comment">&lt;!-- Se ejecuta para CADA respuesta saliente --&gt;</span>
        <span class="xml-tag">&lt;Response&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-log-builder<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span>
        <span class="xml-tag">&lt;/Response&gt;</span>
    <span class="xml-tag">&lt;/PostFlow&gt;</span>
    <span class="xml-tag">&lt;Flows&gt;</span>
        <span class="xml-comment">&lt;!-- Flujo condicional para una operación específica --&gt;</span>
        <span class="xml-tag">&lt;Flow</span> <span class="xml-attribute">name=</span><span class="xml-value">"debt"</span><span class="xml-tag">&gt;</span>
            <span class="xml-tag">&lt;Request&gt;</span>
                <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>oas-validation<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Valida contra la especificación OpenAPI --&gt;</span>
            <span class="xml-tag">&lt;/Request&gt;</span>
            <span class="xml-tag">&lt;Response/&gt;</span>
            <span class="xml-tag">&lt;Condition&gt;</span>(proxy.pathsuffix MatchesPath "/debt/{id}") and (request.verb = "GET")<span class="xml-tag">&lt;/Condition&gt;</span>
        <span class="xml-tag">&lt;/Flow&gt;</span>
    <span class="xml-tag">&lt;/Flows&gt;</span>
    <span class="xml-tag">&lt;HTTPProxyConnection&gt;</span>
        <span class="xml-tag">&lt;BasePath&gt;</span>/debtmanagement/v1<span class="xml-tag">&lt;/BasePath&gt;</span>
        <span class="xml-tag">&lt;VirtualHost&gt;</span>VHost-Secure<span class="xml-tag">&lt;/VirtualHost&gt;</span> <span class="xml-comment">&lt;!-- Define el host y puerto de escucha --&gt;</span>
    <span class="xml-tag">&lt;/HTTPProxyConnection&gt;</span>
    <span class="xml-tag">&lt;RouteRule</span> <span class="xml-attribute">name=</span><span class="xml-value">"default"</span><span class="xml-tag">&gt;</span>
        <span class="xml-comment">&lt;!-- Envia la solicitud al TargetEndpoint llamado 'default' --&gt;</span>
        <span class="xml-tag">&lt;TargetEndpoint&gt;</span>default<span class="xml-tag">&lt;/TargetEndpoint&gt;</span>
    <span class="xml-tag">&lt;/RouteRule&gt;</span>
<span class="xml-tag">&lt;/ProxyEndpoint&gt;</span></code></pre>
                                </div>
                            </div>
                        </div>
                        <!-- XML Target Endpoint -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTarget">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTarget" aria-expanded="true" aria-controls="collapseTarget">
                                    <strong>XML del TargetEndpoint: <code>default.xml</code></strong>
                                </button>
                            </h2>
                            <div id="collapseTarget" class="accordion-collapse collapse show" aria-labelledby="headingTarget">
                                <div class="accordion-body">
                                    <p>Este es el XML del Target Endpoint. Su función es comunicarse con el servicio de backend. Define cómo manejar las respuestas y los errores que provienen del servidor de destino.</p>
                                    <pre><button class="copy-btn" onclick="copyCode(this)">Copiar</button><code><span class="xml-comment">&lt;!-- 
    El TargetEndpoint define la conexión con el servicio backend.
    Maneja la lógica de cara al servidor de destino.
--&gt;</span>
<span class="xml-tag">&lt;TargetEndpoint</span> <span class="xml-attribute">name=</span><span class="xml-value">"default"</span><span class="xml-tag">&gt;</span>
    <span class="xml-tag">&lt;Description/&gt;</span>
    <span class="xml-tag">&lt;FaultRules&gt;</span>
        <span class="xml-comment">&lt;!-- Manejo de errores específicos del backend --&gt;</span>
        <span class="xml-tag">&lt;FaultRule</span> <span class="xml-attribute">name=</span><span class="xml-value">"SimpleErrorHandler"</span><span class="xml-tag">&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-handle-backend-error<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-log-builder<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span>
        <span class="xml-tag">&lt;/FaultRule&gt;</span>
    <span class="xml-tag">&lt;/FaultRules&gt;</span>
    <span class="xml-tag">&lt;PreFlow</span> <span class="xml-attribute">name=</span><span class="xml-value">"PreFlow"</span><span class="xml-tag">&gt;</span>
        <span class="xml-tag">&lt;Request/&gt;</span>
        <span class="xml-tag">&lt;Response&gt;</span>
            <span class="xml-comment">&lt;!-- POLÍTICAS aplicadas a la respuesta del backend --&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>add-cors<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Agrega cabeceras CORS --&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>am-set-date-header<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span> <span class="xml-comment">&lt;!-- POLÍTICA: Agrega una cabecera de fecha --&gt;</span>
        <span class="xml-tag">&lt;/Response&gt;</span>
    <span class="xml-tag">&lt;/PreFlow&gt;</span>
    <span class="xml-tag">&lt;PostFlow</span> <span class="xml-attribute">name=</span><span class="xml-value">"PostFlow"</span><span class="xml-tag">&gt;</span>
        <span class="xml-tag">&lt;Request/&gt;</span>
        <span class="xml-tag">&lt;Response&gt;</span>
            <span class="xml-tag">&lt;Step&gt;&lt;Name&gt;</span>fc-log-builder<span class="xml-tag">&lt;/Name&gt;&lt;/Step&gt;</span>
        <span class="xml-tag">&lt;/Response&gt;</span>
    <span class="xml-tag">&lt;/PostFlow&gt;</span>
    <span class="xml-tag">&lt;HTTPTargetConnection&gt;</span>
        <span class="xml-comment">&lt;!-- Define la conexión al backend, puede usar un balanceador de carga --&gt;</span>
        <span class="xml-tag">&lt;LoadBalancer&gt;</span>
            <span class="xml-tag">&lt;Server</span> <span class="xml-attribute">name=</span><span class="xml-value">"ts-debtmanagement"</span><span class="xml-tag">/&gt;</span> <span class="xml-comment">&lt;!-- Referencia a un TargetServer configurado --&gt;</span>
        <span class="xml-tag">&lt;/LoadBalancer&gt;</span>
        <span class="xml-tag">&lt;Path&gt;</span>/debtmanagement/v1<span class="xml-tag">&lt;/Path&gt;</span> <span class="xml-comment">&lt;!-- Ruta específica del servicio en el backend --&gt;</span>
    <span class="xml-tag">&lt;/HTTPTargetConnection&gt;</span>
<span class="xml-tag">&lt;/TargetEndpoint&gt;</span></code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="section-separator">

        <!-- Módulo 4: Publicación y Consumo -->
        <section id="publicacion">
            <div class="module-card">
                <div class="module-header">
                    <div class="module-number">4</div>
                    <h2 class="m-0">Ciclo de Vida: Publicación y Consumo</h2>
                </div>
                <p class="lead">Una vez que un proxy es funcional, se debe controlar quién puede usarlo y cómo. Para esto, Apigee usa dos conceptos clave: <strong>API Products</strong> y <strong>Developer Apps</strong>.</p>
                <div class="row g-4 mt-4">
                    <div class="col-lg-6">
                        <div class="p-4 border rounded h-100">
                            <h5 class="fw-bold"><i class="bi bi-box2-fill me-2 text-primary"></i>API Products</h5>
                            <p>Piénsalo como un "plan de suscripción". Es un paquete que contiene uno o más API proxies, junto con reglas de acceso (ej. cuota de 100 llamadas por minuto). Creas diferentes productos para diferentes tipos de consumidores.</p>
                        </div>
                    </div>
                     <div class="col-lg-6">
                        <div class="p-4 border rounded h-100">
                            <h5 class="fw-bold"><i class="bi bi-app-indicator me-2 text-primary"></i>Developer Apps</h5>
                            <p>Representan a la aplicación cliente. Cuando un desarrollador registra su app, se le da acceso a uno o más "API Products" y se generan las credenciales (Consumer Key & Secret) para autenticarse.</p>
                        </div>
                    </div>
                </div>
                <div class="alert alert-success mt-4">
                    <i class="bi bi-diagram-3-fill me-2"></i>
                    <strong>En resumen:</strong> Las <strong>Apps</strong> se suscriben a los <strong>Productos</strong> para poder consumir los <strong>Proxies</strong> que estos contienen.
                </div>
            </div>
        </section>

    </main>

    <!-- Modal para respuesta de AI -->
    <div class="modal fade" id="aiResponseModal" tabindex="-1" aria-labelledby="aiResponseModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="aiResponseModalLabel"><i class="bi bi-robot me-2"></i>Explicación del Asistente AI</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body" id="ai-response-content" style="min-height: 200px;">
            <!-- Contenido dinámico aquí -->
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5><i class="bi bi-box-seam-fill me-2"></i> Apigee Training</h5>
                    <p class="small">Herramienta de formación interna para dominar la gestión de APIs.</p>
                </div>
                <div class="col-md-2 offset-md-2 mb-4 mb-md-0">
                    <h5>Navegación</h5>
                    <ul class="list-unstyled">
                        <li><a href="#inicio">Inicio</a></li>
                        <li><a href="#fundamentos">Fundamentos</a></li>
                        <li><a href="#creacion">Módulos</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Recursos</h5>
                     <ul class="list-unstyled">
                        <li><a href="https://docs.apigee.com" target="_blank"><i class="bi bi-book me-2"></i>Documentación Oficial</a></li>
                        <li><a href="https://community.apigee.com" target="_blank"><i class="bi bi-people me-2"></i>Comunidad de Apigee</a></li>
                        <li><a href="https://www.youtube.com/playlist?list=PLIXjuPlujxxz3UXTytamxUB8EGzbaqAqQ" target="_blank"><i class="bi bi-play-circle me-2"></i>Videos de Capacitación</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-4">
            <div class="text-center small">
                <p>&copy; 2025 Portal de Capacitación. Diseñado y desarrollado por <strong>Kevin Arauz</strong>.</p>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Enhanced search functionality
        function initializeSearch() {
            const searchInput = document.getElementById('global-search');
            const searchResults = document.getElementById('search-results');
            
            if (!searchInput || !searchResults) return;
            
            const searchableContent = [
                { title: 'Apigee Edge vs X', content: 'diferencias versiones clásico moderno migración interfaz arquitectura', section: 'diferencias-versiones' },
                { title: 'Interfaz Naranja', content: 'apigee edge clásico UI management server on-premise híbrido', section: 'diferencias-versiones' },
                { title: 'Apigee X Cloud', content: 'serverless google cloud platform GCP modern interface', section: 'diferencias-versiones' },
                { title: 'API', content: 'interfaz programación aplicación contrato digital comunicación datos', section: 'que-es-api' },
                { title: 'Apigee Edge', content: 'plataforma gestión APIs proxy policies analíticas developer portal', section: 'que-es-api' },
                { title: 'API Proxy', content: 'fachada digital intermediario backend', section: 'creacion' },
                { title: 'Policy', content: 'bloque construcción modular seguridad transformación', section: 'estructura' },
                { title: 'KVM', content: 'key value map configuración externa diccionario', section: 'componentes' },
                { title: 'Shared Flow', content: 'flujo compartido reutilizable políticas comunes', section: 'componentes' },
                { title: 'Target Server', content: 'abstracción backend URL ambiente configuración', section: 'componentes' },
                { title: 'Virtual Host', content: 'punto entrada dominio puerto certificado SSL', section: 'componentes' },
                { title: 'Proxy Endpoint', content: 'cara pública cliente solicitudes seguridad cuotas', section: 'estructura' },
                { title: 'Target Endpoint', content: 'conexión backend servicios respuestas errores', section: 'estructura' },
                { title: 'API Products', content: 'plan suscripción paquete proxies reglas acceso', section: 'publicacion' },
                { title: 'Developer Apps', content: 'aplicación cliente credenciales consumer key secret', section: 'publicacion' },
                { title: 'OAuth', content: 'autenticación autorización token seguridad', section: 'fundamentos' },
                { title: 'Analytics', content: 'análisis métricas uso rendimiento datos', section: 'fundamentos' }
            ];
            
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                const query = this.value.toLowerCase().trim();
                
                if (query.length < 2) {
                    searchResults.style.display = 'none';
                    return;
                }
                
                searchTimeout = setTimeout(() => {
                    const matches = searchableContent.filter(item => 
                        item.title.toLowerCase().includes(query) || 
                        item.content.toLowerCase().includes(query)
                    ).slice(0, 5);
                    
                    if (matches.length > 0) {
                        searchResults.innerHTML = matches.map(match => 
                            `<div class="search-result-item" onclick="navigateToSection('${match.section}')">
                                <div class="search-result-title">${match.title}</div>
                                <div class="search-result-context">Encontrado en ${getSectionName(match.section)}</div>
                            </div>`
                        ).join('');
                        searchResults.style.display = 'block';
                    } else {
                        searchResults.innerHTML = '<div class="search-result-item">No se encontraron resultados</div>';
                        searchResults.style.display = 'block';
                    }
                }, 300);
            });
            
            // Hide search results when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    searchResults.style.display = 'none';
                }
            });
        }
        
        function getSectionName(sectionId) {
            const sectionNames = {
                'fundamentos': 'Fundamentos',
                'creacion': 'Módulo 1: Creación',
                'componentes': 'Módulo 2: Componentes',
                'estructura': 'Módulo 3: Estructura',
                'publicacion': 'Módulo 4: Publicación'
            };
            return sectionNames[sectionId] || 'Manual';
        }
        
        function navigateToSection(sectionId) {
            document.getElementById('search-results').style.display = 'none';
            document.getElementById('global-search').value = '';
            smoothScrollToSection(sectionId);
        }

        // Smooth scroll function
        function smoothScrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                const navbarHeight = document.querySelector('.navbar').offsetHeight;
                const targetPosition = section.offsetTop - navbarHeight - 20;
                
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
                
                // Update active nav item
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                const activeLink = document.querySelector(`.nav-link[href="#${sectionId}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }
        }

        // Theme toggle functionality
        function initializeThemeToggle() {
            const themeToggle = document.getElementById('theme-toggle');
            if (!themeToggle) return;
            
            const currentTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', currentTheme);
            
            if (currentTheme === 'dark') {
                themeToggle.innerHTML = '<i class="bi bi-sun-fill"></i>';
            }
            
            themeToggle.addEventListener('click', function() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                this.innerHTML = newTheme === 'dark' ? 
                    '<i class="bi bi-sun-fill"></i>' : 
                    '<i class="bi bi-moon-fill"></i>';
            });
        }

        // Print functionality
        function showPrintDialog() {
            // Hide interactive elements before printing
            const elementsToHide = document.querySelectorAll('.navbar, .scroll-progress, #theme-toggle, .btn, .search-container, #asistente-ai');
            elementsToHide.forEach(el => el.style.display = 'none');
            
            window.print();
            
            // Restore elements after printing
            setTimeout(() => {
                elementsToHide.forEach(el => el.style.display = '');
            }, 1000);
        }

        // Enhanced keyboard navigation
        function initializeKeyboardNavigation() {
            document.addEventListener('keydown', function(e) {
                // Ctrl/Cmd + K for search focus
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    const searchInput = document.getElementById('global-search');
                    if (searchInput) {
                        searchInput.focus();
                        searchInput.select();
                    }
                }
                
                // Escape to close search results
                if (e.key === 'Escape') {
                    document.getElementById('search-results').style.display = 'none';
                }
                
                // Ctrl/Cmd + P for print
                if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                    e.preventDefault();
                    showPrintDialog();
                }
            });
        }

        // Reading progress and estimated time
        function initializeReadingProgress() {
            const totalWords = document.body.innerText.split(/\s+/).length;
            const avgWordsPerMinute = 200;
            const estimatedTime = Math.ceil(totalWords / avgWordsPerMinute);
            
            // Add reading time indicator
            const heroSection = document.querySelector('.hero .lead');
            if (heroSection) {
                const readingTime = document.createElement('small');
                readingTime.className = 'text-white-50 d-block mt-2';
                readingTime.innerHTML = `<i class="bi bi-clock me-1"></i> Tiempo estimado de lectura: ${estimatedTime} minutos`;
                heroSection.parentNode.insertBefore(readingTime, heroSection.nextSibling);
            }
        }

        // --- Globally Scoped Functions for onclick handlers ---
        function downloadPDF() {
            alert('Función de descarga PDF en desarrollo. Use la opción de imprimir (Ctrl+P) y seleccione "Guardar como PDF".');
        }

        function downloadTextFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function downloadCheatSheet() {
            const cheatSheetContent = `
APIGEE EDGE - CHEAT SHEET RÁPIDO
================================

COMANDOS FRECUENTES:
- Management API: https://api.enterprise.apigee.com
- Edge UI: https://enterprise.apigee.com
- Crear Proxy: APIs → +API Proxy
- Deploy: Deployment → Deploy
- Debug: Develop → Trace

POLÍTICAS MÁS USADAS:
- OAuth v2.0 (Autenticación)
- Verify API Key (Validación de clave)
- Quota (Límites de uso)
- Spike Arrest (Control de tráfico)
- CORS (Cross-Origin)
- JSON to XML (Transformación)

TROUBLESHOOTING:
- Error 401: Verificar API Key/OAuth
- Error 429: Revisar Quota/Rate Limit
- Error 500: Verificar Target Endpoint
- Timeout: Ajustar timeout policies

BUENAS PRÁCTICAS:
✓ Siempre usar versionado en APIs
✓ Implementar rate limiting
✓ Usar políticas de cache apropiadas
✓ Monitorear analytics regularmente
✓ Documentar todas las APIs

© 2025 Manual de Capacitación Apigee Edge - Kevin Arauz
            `.trim();
            downloadTextFile('apigee-cheat-sheet.txt', cheatSheetContent);
        }

        // Function to copy code from <pre> blocks
        function copyCode(button) {
            const pre = button.closest('pre');
            const code = pre.querySelector('code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                button.innerHTML = '<i class="bi bi-check-lg"></i> Copiado';
                button.classList.add('copied');
                setTimeout(() => {
                    button.innerHTML = 'Copiar';
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Error al copiar: ', err);
                button.innerText = 'Error';
            });
        }

        // Modal instance for the AI assistant
        const aiModal = new bootstrap.Modal(document.getElementById('aiResponseModal'));
        
        function setExampleQuery(concept) {
            const input = document.getElementById('ai-concept-input');
            input.value = concept;
            input.focus();
        }

        // Async function to handle the AI assistant click event
        async function handleAsistenteClick() {
            const input = document.getElementById('ai-concept-input');
            const concept = input.value.trim();
            if (!concept) {
                alert('Por favor, ingresa un concepto.');
                return;
            }

            const button = document.getElementById('ai-assistant-btn');
            const buttonText = document.getElementById('ai-btn-text');
            const spinner = document.getElementById('ai-btn-spinner');
            const responseContainer = document.getElementById('ai-response-content');

            // Set loading state
            button.disabled = true;
            buttonText.textContent = 'Pensando...';
            spinner.classList.remove('d-none');
            responseContainer.innerHTML = `<div class="d-flex justify-content-center align-items-center h-100"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Cargando...</span></div></div>`;
            aiModal.show();

            try {
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1500));

                // Enhanced explanations with context from the XML glossary
                const explanations = {
                    'api proxy': {
                        title: 'API Proxy',
                        icon: 'bi-box-seam',
                        definition: 'Es una fachada digital inteligente que actúa como intermediario entre los desarrolladores y tus servicios de backend.',
                        analogy: '🏨 <strong>Analogía:</strong> Como el recepcionista de un hotel de lujo - los huéspedes (desarrolladores) interactúan con él, no directamente con las habitaciones (servicios backend). El recepcionista gestiona el acceso, proporciona información y asegura que todo funcione sin problemas.',
                        benefits: ['Seguridad centralizada', 'Transformación de datos', 'Monitoreo y analytics', 'Control de tráfico', 'Versionado sin cambiar backend'],
                        example: 'Un API Proxy puede transformar respuestas XML a JSON, aplicar autenticación OAuth y limitar a 1000 llamadas por hora, todo sin tocar tu servicio original.',
                        xmlContext: 'En el XML se define como <ProxyEndpoint> que maneja la interfaz pública del API.'
                    },
                    'reverse proxy': {
                        title: 'Reverse Proxy',
                        icon: 'bi-arrow-left-right',
                        definition: 'Un servidor que se posiciona frente a servidores web/aplicaciones y reenvía las solicitudes de los clientes a esos servidores.',
                        analogy: '🎭 <strong>Analogía:</strong> Como un portero de discoteca VIP - para los clientes, él es la cara visible del establecimiento, pero internamente gestiona el acceso a múltiples áreas y servicios.',
                        benefits: ['Balanceo de carga', 'Caché de respuestas', 'Terminación SSL', 'Compresión', 'Ocultación de infraestructura'],
                        example: 'En Apigee, cuando creas un "Reverse Proxy", estás exponiendo una URL pública (/v1/users) que internamente puede conectar con https://backend.empresa.com/api/usuarios.',
                        xmlContext: 'Se configura mediante <HTTPProxyConnection> y <HTTPTargetConnection> en el XML.'
                    },
                    'preflow': {
                        title: 'PreFlow',
                        icon: 'bi-arrow-right-circle',
                        definition: 'Contenedor de lógica que se ejecuta SIEMPRE al inicio de cada solicitud, antes de cualquier flujo condicional.',
                        analogy: '🚦 <strong>Analogía:</strong> Como el control de seguridad del aeropuerto - todos los pasajeros DEBEN pasar por ahí, sin excepciones, antes de acceder a las puertas de embarque.',
                        benefits: ['Lógica universal', 'Seguridad garantizada', 'Inicialización', 'Logging consistente'],
                        example: 'En PreFlow pones: generación de UUID, validación OAuth, carga de KVM, aplicación de cuotas. Se ejecuta para TODAS las solicitudes.',
                        xmlContext: 'Se define como <PreFlow> en tanto ProxyEndpoint como TargetEndpoint. Contiene <Request> y <Response> con sus respectivos <Step>s.'
                    },
                    'postflow': {
                        title: 'PostFlow',
                        icon: 'bi-arrow-left-circle',
                        definition: 'Contenedor de lógica que se ejecuta SIEMPRE al final, después de todos los flujos, antes de enviar la respuesta al cliente.',
                        analogy: '📤 <strong>Analogía:</strong> Como el departamento de envíos - sin importar qué producto compraste, todos pasan por empaquetado, etiquetado y registro antes de salir.',
                        benefits: ['Transformación final', 'Headers estándar', 'Logging completo', 'Limpieza de datos'],
                        example: 'En PostFlow pones: agregado de headers CORS, logging de respuesta, transformación final de formato, medición de tiempos de respuesta.',
                        xmlContext: 'Se define como <PostFlow> y típicamente contiene <Response> con Steps de finalización como logging.'
                    },
                    'flows': {
                        title: 'Flows (Flujos Condicionales)',
                        icon: 'bi-diagram-2',
                        definition: 'Contenedores de lógica que se ejecutan SOLO si su condición específica se cumple (path, método HTTP, headers, etc.).',
                        analogy: '🎯 <strong>Analogía:</strong> Como carriles especializados en una autopista - el carril de camiones solo para vehículos pesados, el carril rápido solo para autos.',
                        benefits: ['Lógica específica', 'Optimización', 'Diferentes validaciones', 'Routing inteligente'],
                        example: 'Flow "GetUsers": Condition (request.verb = "GET" AND proxy.pathsuffix = "/users"). Solo ejecuta validación de paginación y cache.',
                        xmlContext: 'Se define dentro de <Flows> con elementos <Flow name="..."> que incluyen <Condition> para determinar cuándo ejecutarse.'
                    },
                    'step': {
                        title: 'Step (Paso)',
                        icon: 'bi-play-circle',
                        definition: 'Es una unidad de ejecución dentro de un flujo que generalmente contiene una política específica para ser ejecutada.',
                        analogy: '⚙️ <strong>Analogía:</strong> Como los pasos de una receta de cocina - cada Step es una instrucción específica (añadir sal, mezclar, hornear) que se ejecuta en orden.',
                        benefits: ['Granularidad', 'Orden de ejecución', 'Condicionalidad', 'Reutilización'],
                        example: '<Step><Name>oauth-validation</Name></Step> ejecuta la política "oauth-validation". Puedes tener múltiples Steps en secuencia.',
                        xmlContext: 'Se define como <Step><Name>nombre-política</Name></Step> dentro de <Request> o <Response> en cualquier flujo.'
                    },
                    'faultrules': {
                        title: 'FaultRules',
                        icon: 'bi-exclamation-triangle',
                        definition: 'Define un conjunto de pasos a seguir cuando ocurre un error específico, permitiendo un manejo de errores personalizado.',
                        analogy: '🚨 <strong>Analogía:</strong> Como los protocolos de emergencia - si hay un incendio (error 500), sigues el plan A; si hay una alarma (error 401), sigues el plan B.',
                        benefits: ['Manejo graceful de errores', 'Respuestas personalizadas', 'Logging de errores', 'Recuperación automática'],
                        example: 'FaultRule para error 401: ejecuta log de seguridad + respuesta JSON estándar. FaultRule para timeout: reintenta una vez + notifica.',
                        xmlContext: 'Se define como <FaultRules><FaultRule name="..."> con Steps específicos para cada tipo de error.'
                    },
                    'condition': {
                        title: 'Condition (Condición)',
                        icon: 'bi-question-circle',
                        definition: 'Una expresión lógica que determina si un Flow, Step o FaultRule debe ejecutarse basándose en variables del request.',
                        analogy: '🔍 <strong>Analogía:</strong> Como las reglas de acceso a un club nocturno - "solo mayores de 21" o "solo con invitación". La condición decide quién entra.',
                        benefits: ['Ejecución condicional', 'Optimización', 'Routing inteligente', 'Personalización'],
                        example: '(request.verb = "GET" AND proxy.pathsuffix MatchesPath "/users/{id}") - solo para GET a URLs como /users/123.',
                        xmlContext: 'Se define como <Condition>expresión_lógica</Condition> dentro de Flows para determinar cuándo ejecutar la lógica.'
                    },
                    'httproxyconnection': {
                        title: 'HTTPProxyConnection',
                        icon: 'bi-globe',
                        definition: 'Define la interfaz pública del proxy, incluyendo el BasePath (ruta base) y el VirtualHost (punto de entrada).',
                        analogy: '🏪 <strong>Analogía:</strong> Como la dirección y horario de una tienda - defines en qué calle está (BasePath), en qué edificio (VirtualHost).',
                        benefits: ['Punto de entrada claro', 'Organización de URLs', 'Configuración de host', 'Separación de ambientes'],
                        example: '<BasePath>/api/v1/users</BasePath> + <VirtualHost>secure</VirtualHost> = https://api.empresa.com/api/v1/users',
                        xmlContext: 'Se define dentro del <ProxyEndpoint> con <BasePath> y <VirtualHost> para configurar el acceso público.'
                    },
                    'routerule': {
                        title: 'RouteRule',
                        icon: 'bi-signpost',
                        definition: 'Conecta el ProxyEndpoint con un TargetEndpoint específico. Puede tener condiciones para enrutar a diferentes backends.',
                        analogy: '🧭 <strong>Analogía:</strong> Como un GPS inteligente - dependiendo del tráfico (condiciones), te envía por diferentes rutas (TargetEndpoints).',
                        benefits: ['Routing dinámico', 'Balanceo de carga', 'Failover', 'A/B testing'],
                        example: 'Ruta por defecto va a "backend-prod". Si header "version=beta", va a "backend-beta".',
                        xmlContext: 'Se define como <RouteRule><TargetEndpoint>nombre</TargetEndpoint></RouteRule> al final del ProxyEndpoint.'
                    },
                    'httptargetconnection': {
                        title: 'HTTPTargetConnection',
                        icon: 'bi-hdd-network',
                        definition: 'Define la conexión con el servicio de backend, ya sea a través de una URL directa o un LoadBalancer.',
                        analogy: '📞 <strong>Analogía:</strong> Como la información de contacto en tu agenda - puede ser un número directo o un número principal con extensiones.',
                        benefits: ['Abstracción de backend', 'Balanceo de carga', 'Configuración flexible', 'Timeouts personalizados'],
                        example: 'URL directa: <URL>https://backend.com/api</URL> o LoadBalancer: <Server name="backend-1"/>',
                        xmlContext: 'Se define dentro del <TargetEndpoint> con <URL> directa o <LoadBalancer> con múltiples <Server>.'
                    },
                    'loadbalancer': {
                        title: 'LoadBalancer / Server',
                        icon: 'bi-diagram-3',
                        definition: 'Permite balancear la carga entre múltiples instancias de backend, haciendo referencia a TargetServers preconfigurados.',
                        analogy: '⚖️ <strong>Analogía:</strong> Como un maître en un restaurante - distribuye a los clientes entre las mesas disponibles para optimizar la atención.',
                        benefits: ['Alta disponibilidad', 'Distribución de carga', 'Failover automático', 'Escalabilidad'],
                        example: '<LoadBalancer><Server name="backend-server-1"/><Server name="backend-server-2"/></LoadBalancer>',
                        xmlContext: 'Se define dentro de <HTTPTargetConnection> con referencias a TargetServers configurados previamente.'
                    },
                    'path': {
                        title: 'Path',
                        icon: 'bi-folder',
                        definition: 'La ruta específica del servicio en el backend que se añadirá a la URL del TargetServer.',
                        analogy: '🗺️ <strong>Analogía:</strong> Como las direcciones específicas dentro de un edificio - el edificio es el TargetServer, el Path es "piso 3, oficina 301".',
                        benefits: ['Especificidad de endpoint', 'Organización clara', 'Ruteo preciso', 'Separación de servicios'],
                        example: 'TargetServer: "https://backend.com" + Path: "/api/v2/users" = llamada final a "https://backend.com/api/v2/users"',
                        xmlContext: 'Se define como <Path>/ruta/específica</Path> dentro de <HTTPTargetConnection> para completar la URL de destino.'
                    },
                    // Conceptos adicionales del manual
                    'api products': {
                        title: 'API Products',
                        icon: 'bi-box2',
                        definition: 'Son "planes de suscripción" que empaquetan uno o más API proxies junto con reglas de acceso específicas.',
                        analogy: '📱 <strong>Analogía:</strong> Como los planes de telefonía móvil - tienes el plan "Básico" (100 llamadas/día), "Premium" (1000 llamadas/día).',
                        benefits: ['Monetización por niveles', 'Control granular de acceso', 'Segmentación de desarrolladores', 'Políticas diferenciadas'],
                        example: 'Producto "Free Tier": incluye APIs de consulta con 100 calls/hora. Producto "Business": incluye APIs + escritura con 10,000 calls/hora.',
                        xmlContext: 'No se definen en XML de proxy, sino en la configuración de Apigee Management para gestionar el acceso.'
                    },
                    'developer apps': {
                        title: 'Developer Apps',
                        icon: 'bi-app-indicator',
                        definition: 'Representan aplicaciones cliente registradas que consumen tus APIs a través de credenciales específicas.',
                        analogy: '🎫 <strong>Analogía:</strong> Como un pase de acceso a un parque temático - cada app tiene su entrada única que le da acceso a ciertas atracciones.',
                        benefits: ['Trazabilidad por aplicación', 'Credenciales únicas', 'Analytics separados', 'Revocación individual'],
                        example: 'App "MiMovil-iOS" obtiene Consumer Key "abc123" para acceder al producto "Premium".',
                        xmlContext: 'Las credenciales se validan en el proxy mediante políticas como VerifyAPIKey que referencia estas apps.'
                    },
                    'kvm': {
                        title: 'Key-Value Maps (KVM)',
                        icon: 'bi-key',
                        definition: 'Almacenes de configuración que permiten externalizar datos como URLs, credenciales y parámetros fuera del código del proxy.',
                        analogy: '🗂️ <strong>Analogía:</strong> Como un archivo de configuración compartido - tienes un "diccionario" central que todos consultan.',
                        benefits: ['Configuración sin redespliegue', 'Separación por ambiente', 'Seguridad para credenciales', 'Mantenimiento centralizado'],
                        example: 'KVM "URLs-Prod": backend_url = "https://api.prod.com", timeout = "30000". Todos los proxies consultan estos valores.',
                        xmlContext: 'Se accede mediante políticas KeyValueMapOperations en Steps del proxy: <Step><Name>KVM-Debtmanagement</Name></Step>'
                    },
                    'target servers': {
                        title: 'Target Servers',
                        icon: 'bi-server',
                        definition: 'Abstracciones que desacoplan las URLs de backend del código, permitiendo diferentes configuraciones por ambiente.',
                        analogy: '🏷️ <strong>Analogía:</strong> Como etiquetas de contacto - en lugar de recordar números, tienes "Casa", "Oficina". Cambias el número sin cambiar dónde la usas.',
                        benefits: ['Despliegue multi-ambiente', 'Cambios sin código', 'Balanceo de carga', 'Failover automático'],
                        example: 'Target Server "backend-api": En dev apunta a "dev.empresa.com", en prod a "api.empresa.com".',
                        xmlContext: 'Se referencia en <LoadBalancer><Server name="ts-debtmanagement"/></LoadBalancer> dentro del TargetEndpoint.'
                    },
                    'shared flow': {
                        title: 'Shared Flows',
                        icon: 'bi-arrows-collapse',
                        definition: 'Secuencias de políticas reutilizables que se definen una vez y se pueden "enganchar" a múltiples proxies.',
                        analogy: '🧩 <strong>Analogía:</strong> Como plantillas corporativas - creas una vez el formato estándar y lo reutilizas en todas las presentaciones.',
                        benefits: ['Reutilización de lógica', 'Mantenimiento centralizado', 'Consistencia', 'Versioning independiente'],
                        example: 'Shared Flow "SecurityFlow": OAuth + Rate Limiting + Logging. Lo adjuntas a 20 proxies diferentes.',
                        xmlContext: 'Se invoca mediante política FlowCallout: <Step><Name>Invoke-SecurityFlow</Name></Step> en cualquier flujo del proxy.'
                    },
                    'oas': {
                        title: 'OpenAPI Specification (OAS)',
                        icon: 'bi-file-earmark-code',
                        definition: 'El "contrato" de tu API que define estructura, endpoints, parámetros y validaciones usando estándares JSON/YAML.',
                        analogy: '📋 <strong>Analogía:</strong> Como el manual de instrucciones - especifica exactamente qué puedes hacer, qué parámetros necesitas y qué respuestas esperar.',
                        benefits: ['Validación automática', 'Documentación viva', 'Generación de código', 'Testing automatizado'],
                        example: 'OAS define que POST /users requiere {name: string, email: string}, retorna 201 con {id: number}.',
                        xmlContext: 'Se valida mediante política OpenAPISpecification: <Step><Name>oas-validation</Name></Step> en flows específicos.'
                    },
                    'virtual host': {
                        title: 'Virtual Hosts',
                        icon: 'bi-hdd-network',
                        definition: 'Define el punto de entrada (dominio y puerto) por donde se accederá a los proxies, incluyendo configuración SSL.',
                        analogy: '🚪 <strong>Analogía:</strong> Como las diferentes entradas de un edificio - tienes la entrada principal (HTTPS), la de empleados (HTTP interno).',
                        benefits: ['Múltiples dominios', 'Configuración SSL', 'Routing por host', 'Separación de tráfico'],
                        example: 'VHost "api-secure": api.empresa.com:443 con SSL. VHost "internal": internal.empresa.com:8080 sin SSL.',
                        xmlContext: 'Se referencia en <VirtualHost>VHost-Secure</VirtualHost> dentro de <HTTPProxyConnection> del ProxyEndpoint.'
                    }
                };
                
                // Enhanced search logic
                const normalizedConcept = concept.toLowerCase().replace(/[^a-z0-9\s]/g, '').trim();
                let explanation = null;
                
                // Direct match
                if (explanations[normalizedConcept]) {
                    explanation = explanations[normalizedConcept];
                } else {
                    // Partial match
                    for (const [key, value] of Object.entries(explanations)) {
                        if (normalizedConcept.includes(key) || key.includes(normalizedConcept)) {
                            explanation = value;
                            break;
                        }
                    }
                }
                
                if (explanation) {
                    responseContainer.innerHTML = `
                        <div class="d-flex align-items-start mb-4">
                            <div class="me-3">
                                <div class="ai-modal-icon">
                                    <i class="bi ${explanation.icon}" style="font-size: 1.5rem;"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h4 class="fw-bold text-primary mb-3">${explanation.title}</h4>
                                <div class="ai-definition-box p-3">
                                    <h6 class="fw-bold mb-2"><i class="bi bi-lightbulb me-2"></i>Definición</h6>
                                    <p class="mb-0">${explanation.definition}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <div class="ai-analogy-box p-3">
                                <p class="mb-0">${explanation.analogy}</p>
                            </div>
                        </div>
                        
                        <div class="row g-4 mb-4">
                            <div class="col-md-6">
                                <h6 class="fw-bold text-success mb-3"><i class="bi bi-check-circle me-2"></i>Beneficios Clave</h6>
                                <ul class="list-unstyled">
                                    ${explanation.benefits.map(benefit => `<li class="ai-benefit-item mb-1"><i class="bi bi-arrow-right text-success me-2"></i>${benefit}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6 class="fw-bold text-info mb-3"><i class="bi bi-code-square me-2"></i>Ejemplo Práctico</h6>
                                <div class="ai-example-box p-3">
                                    <small class="text-light">${explanation.example}</small>
                                </div>
                            </div>
                        </div>
                        
                        ${explanation.xmlContext ? `
                        <div class="mb-4">
                            <div class="ai-xml-context p-3">
                                <h6 class="fw-bold mb-2"><i class="bi bi-file-earmark-code me-2"></i>Contexto en XML</h6>
                                <p class="mb-0">${explanation.xmlContext}</p>
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="text-center mt-4 pt-3 ai-modal-footer" style="border-top: 1px solid rgba(0,0,0,0.1);">
                            <small class="text-muted">
                                <i class="bi bi-info-circle me-1"></i>
                                ¿Necesitas más detalles? Consulta los módulos correspondientes en el manual o busca en la documentación oficial de Apigee.
                            </small>
                        </div>
                    `;
                } else {
                    responseContainer.innerHTML = `
                        <div class="text-center py-4">
                            <div class="ai-modal-icon mx-auto mb-4">
                                <i class="bi bi-search" style="font-size: 1.5rem;"></i>
                            </div>
                            <h5 class="fw-bold mb-3">Término no encontrado</h5>
                            <p class="text-muted mb-4">Lo siento, no tengo una explicación para "<strong>${concept}</strong>" en mi base de conocimientos actual.</p>
                            <div class="ai-definition-box p-3">
                                <h6 class="fw-bold mb-2"><i class="bi bi-lightbulb me-2"></i>Sugerencias:</h6>
                                <ul class="list-unstyled text-start mb-0">
                                    <li class="ai-benefit-item mb-2"><i class="bi bi-arrow-right text-info me-2"></i>Intenta con términos como: API Proxy, PreFlow, PostFlow, Flows, Step</li>
                                    <li class="ai-benefit-item mb-2"><i class="bi bi-arrow-right text-info me-2"></i>Revisa el glosario XML en el Módulo 3</li>
                                    <li class="ai-benefit-item mb-0"><i class="bi bi-arrow-right text-info me-2"></i>Consulta la documentación oficial de Apigee</li>
                                </ul>
                            </div>
                        </div>
                    `;
                }

            } catch (error) {
                responseContainer.innerHTML = `<div class="alert alert-danger">Ocurrió un error al procesar tu solicitud.</div>`;
                console.error(error);
            } finally {
                // Reset button state
                button.disabled = false;
                buttonText.innerHTML = '<i class="bi bi-stars me-2"></i> Explicar Concepto';
                spinner.classList.add('d-none');
            }
        }

        // --- Initialization code that runs after the DOM is fully loaded ---
        window.onload = function() {
            const scrollProgress = document.getElementById('scroll-progress');
            const navbar = document.getElementById('navbar-main');

            // Initialize all enhanced features
            initializeSearch();
            initializeThemeToggle();
            initializeKeyboardNavigation();
            initializeReadingProgress();

            // Function to update scroll progress bar
            function updateScrollProgress() {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;
                if(scrollProgress) {
                    scrollProgress.style.width = scrollPercent + '%';
                }
            }

            // Function to handle navbar style on scroll
            function handleNavScroll() {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            }
            
            // Attach scroll event listeners
            window.addEventListener('scroll', () => {
                updateScrollProgress();
                handleNavScroll();
            });

            // Set up smooth scrolling for all anchor links
            document.querySelectorAll('a[href^="#"]:not([href="#"])').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Service Worker for offline functionality (basic) - Optional
            if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
                // Only register service worker on HTTPS and if supported
                try {
                    navigator.serviceWorker.register('sw.js').catch(() => {
                        // Silently fail if sw.js doesn't exist - that's ok
                        console.log('Service Worker not available - manual works fine without it');
                    });
                } catch (error) {
                    // Ignore service worker errors - the manual works perfectly without it
                    console.log('Service Worker not supported - manual works fine without it');
                }
            }
        };
    </script>
</body>
</html>
